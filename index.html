<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Beron</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  -webkit-tap-highlight-color:transparent;
  -webkit-touch-callout:none;
  -webkit-user-select:none;
  user-select:none;
}

body{
  background:#000;
  color:#fff;
  font-family:'Poppins',sans-serif;
  overflow-x:hidden;
}

.app{
  width:100%;
  max-width:430px;
  min-height:100vh;
  margin:0 auto;
  background:#0a0a0f;
  position:relative;
  overflow-y:auto;
  overflow-x:hidden;
  padding-bottom:80px;
}

.animated-bg{
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,0.15) 0%, transparent 50%),
    radial-gradient(circle at 80% 70%, rgba(200,200,200,0.15) 0%, transparent 50%),
    radial-gradient(circle at 50% 50%, rgba(255,255,255,0.1) 0%, transparent 50%);
  pointer-events:none;
  z-index:0;
  animation:bgPulse 8s ease-in-out infinite;
}

@keyframes bgPulse{
  0%,100%{opacity:0.5}
  50%{opacity:1}
}

.scan-lines{
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    0deg,
    rgba(200,200,200,0.03) 0px,
    transparent 2px,
    transparent 4px,
    rgba(200,200,200,0.03) 4px
  );
  pointer-events:none;
  z-index:1;
  animation:scan 8s linear infinite;
}

@keyframes scan{
  0%{transform:translateY(0)}
  100%{transform:translateY(100px)}
}

.content{
  position:relative;
  z-index:2;
  padding:15px;
}

.tab-content{
  display:none;
}

.tab-content.active{
  display:block;
}

.header{
  text-align:center;
  margin-bottom:20px;
  animation:slideDown 0.6s ease-out;
}

@keyframes slideDown{
  from{transform:translateY(-30px);opacity:0}
  to{transform:translateY(0);opacity:1}
}

.logo{
  font-family:'Poppins',sans-serif;
  font-size:48px;
  font-weight:900;
  background:linear-gradient(135deg,#fff 0%,#e0e0e0 50%,#fff 100%);
  background-size:200%;
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
  text-shadow:0 0 60px rgba(255,255,255,0.8);
  animation:logoGlow 3s ease infinite;
  letter-spacing:8px;
  position:relative;
}

@keyframes logoGlow{
  0%,100%{background-position:0% 50%;filter:drop-shadow(0 0 20px rgba(255,255,255,0.6))}
  50%{background-position:100% 50%;filter:drop-shadow(0 0 40px rgba(200,200,200,0.8))}
}

.stats-box{
  background:rgba(30,30,40,0.8);
  border-radius:20px;
  padding:20px;
  margin-bottom:20px;
  border:2px solid rgba(200,200,200,0.3);
  box-shadow:0 10px 40px rgba(200,200,200,0.2);
  backdrop-filter:blur(20px);
  animation:fadeIn 0.8s ease-out 0.2s both;
  position:relative;
  overflow:hidden;
}

.stats-box::before{
  content:'';
  position:absolute;
  top:-50%;
  left:-50%;
  width:200%;
  height:200%;
  background:linear-gradient(45deg,transparent,rgba(200,200,200,0.1),transparent);
  animation:shimmer 3s linear infinite;
}

@keyframes shimmer{
  0%{transform:translateX(-100%) translateY(-100%) rotate(45deg)}
  100%{transform:translateX(100%) translateY(100%) rotate(45deg)}
}

@keyframes fadeIn{
  from{opacity:0;transform:scale(0.95)}
  to{opacity:1;transform:scale(1)}
}

.coins{
  font-size:36px;
  font-weight:bold;
  color:#fff;
  text-shadow:0 0 30px rgba(255,255,255,0.8);
  margin-bottom:10px;
  font-family:'Poppins',sans-serif;
  position:relative;
  z-index:1;
}

.passive-income{
  font-size:14px;
  color:#4ade80;
  text-shadow:0 0 10px rgba(74,222,128,0.5);
  margin-top:5px;
  font-weight:600;
}

.currency-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-top:12px;
  position:relative;
  z-index:1;
}

.currency-item{
  background:rgba(0,0,0,0.4);
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(200,200,200,0.2);
  transition:all 0.3s;
}

.currency-item:active{
  transform:scale(0.95);
  border-color:rgba(200,200,200,0.5);
}

.currency-label{
  font-size:11px;
  color:#ccc;
  margin-bottom:4px;
  text-transform:uppercase;
  letter-spacing:1px;
}

.currency-value{
  font-size:18px;
  font-weight:700;
  color:#fff;
}

.rank-badge{
  background:linear-gradient(135deg,#f5f5f5,#e0e0e0);
  padding:8px 16px;
  border-radius:20px;
  font-weight:700;
  font-size:14px;
  text-align:center;
  margin-top:10px;
  box-shadow:0 5px 20px rgba(255,255,255,0.3);
  position:relative;
  z-index:1;
  color:#333;
}

.energy-bar{
  width:100%;
  height:10px;
  background:rgba(0,0,0,0.6);
  border-radius:10px;
  margin-top:15px;
  overflow:hidden;
  border:1px solid rgba(200,200,200,0.3);
  position:relative;
  z-index:1;
}

.energy-fill{
  height:100%;
  background:linear-gradient(90deg,#ccc,#00ff64);
  border-radius:10px;
  transition:width 0.3s;
  box-shadow:0 0 15px rgba(200,200,200,0.8);
}

.tap-section{
  text-align:center;
  margin:25px auto;
  animation:fadeIn 1s ease-out 0.4s both;
  display:flex;
  justify-content:center;
  align-items:center;
}

.tap-btn{
  width:180px;
  height:180px;
  border-radius:50%;
  border:none;
  background:linear-gradient(135deg,#b8b8b8 0%,#888 100%);
  color:#fff;
  font-size:36px;
  font-weight:900;
  font-family:'Poppins',sans-serif;
  cursor:pointer;
  box-shadow:
    0 0 40px rgba(180,180,180,0.5),
    0 0 60px rgba(150,150,150,0.3),
    inset 0 0 20px rgba(200,200,200,0.2);
  transition:all 0.15s;
  position:relative;
  overflow:hidden;
  touch-action:none;
  display:flex;
  align-items:center;
  justify-content:center;
  margin:0 auto;
}

.tap-btn::before{
  content:'';
  position:absolute;
  inset:-20px;
  background:conic-gradient(from 0deg,transparent,rgba(200,200,200,0.3),transparent);
  animation:rotate 2s linear infinite;
}

@keyframes rotate{
  0%{transform:rotate(0deg)}
  100%{transform:rotate(360deg)}
}

.tap-btn-content{
  position:relative;
  z-index:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:5px;
}

.tap-btn-skin{
  font-size:60px;
  filter:drop-shadow(0 0 10px rgba(255,255,255,0.5));
}

.tap-btn-text{
  font-size:18px;
  font-weight:700;
}

.tap-btn:active{
  transform:scale(0.9);
  box-shadow:
    0 0 30px rgba(180,180,180,0.6),
    inset 0 0 30px rgba(0,0,0,0.4);
}

.tap-btn.cooldown{
  opacity:0.6;
  cursor:not-allowed;
  animation:shake 0.3s;
}

@keyframes shake{
  0%,100%{transform:translateX(0)}
  25%{transform:translateX(-5px)}
  75%{transform:translateX(5px)}
}

.click-effect{
  position:fixed;
  pointer-events:none;
  font-size:28px;
  font-weight:bold;
  color:#fff;
  text-shadow:0 0 20px rgba(255,255,255,1);
  animation:floatUp 1.2s ease-out forwards;
  z-index:9999;
  font-family:'Poppins',sans-serif;
}

@keyframes floatUp{
  0%{opacity:1;transform:translateY(0) scale(1)}
  100%{opacity:0;transform:translateY(-120px) scale(1.8)}
}

.quick-actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin:20px 0;
  animation:fadeIn 1.2s ease-out 0.6s both;
}

.action-btn{
  background:linear-gradient(135deg,rgba(160,160,160,0.4),rgba(120,120,120,0.4));
  border:2px solid rgba(200,200,200,0.5);
  color:#e0e0e0;
  padding:15px;
  border-radius:15px;
  font-size:15px;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s;
  backdrop-filter:blur(10px);
  text-shadow:0 0 10px rgba(200,200,200,0.5);
}

.action-btn:hover{
  background:linear-gradient(135deg,rgba(180,180,180,0.5),rgba(140,140,140,0.5));
  transform:translateY(-3px);
  box-shadow:0 8px 25px rgba(180,180,180,0.4);
}

.action-btn:active{
  transform:translateY(0);
}

.section-title{
  font-family:'Poppins',sans-serif;
  font-size:24px;
  color:#e0e0e0;
  margin:25px 0 15px 0;
  text-shadow:0 0 20px rgba(224,224,224,0.8);
  text-align:center;
  letter-spacing:2px;
}

.games-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

.game-card{
  background:linear-gradient(135deg,rgba(60,40,80,0.8),rgba(40,60,80,0.8));
  border:2px solid rgba(200,200,200,0.3);
  border-radius:15px;
  padding:18px;
  text-align:center;
  cursor:pointer;
  transition:all 0.3s;
  backdrop-filter:blur(10px);
  position:relative;
  overflow:hidden;
}

.game-card::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,transparent,rgba(200,200,200,0.1));
  opacity:0;
  transition:opacity 0.3s;
}

.game-card:hover::before{
  opacity:1;
}

.game-card:hover{
  transform:translateY(-5px) scale(1.02);
  border-color:rgba(200,200,200,0.6);
  box-shadow:0 15px 40px rgba(200,200,200,0.4);
}

.game-icon{
  font-size:48px;
  margin-bottom:10px;
  filter:drop-shadow(0 0 15px rgba(200,200,200,0.6));
}

.game-name{
  font-size:16px;
  font-weight:700;
  color:#e0e0e0;
  text-shadow:0 0 10px rgba(224,224,224,0.5);
  margin-bottom:5px;
}

.cases-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:15px;
  margin-top:20px;
}

.case-card{
  background:linear-gradient(135deg,rgba(30,30,45,0.95),rgba(20,20,35,0.95));
  border:3px solid;
  border-radius:20px;
  padding:20px;
  text-align:center;
  cursor:pointer;
  transition:all 0.4s;
  backdrop-filter:blur(20px);
  position:relative;
  overflow:hidden;
}

.case-card::before{
  content:'';
  position:absolute;
  inset:-3px;
  background:linear-gradient(45deg,transparent,rgba(255,255,255,0.15),transparent);
  animation:shine 5s linear infinite;
  z-index:0;
}

@keyframes shine{
  0%{transform:translateX(-100%) rotate(45deg)}
  100%{transform:translateX(200%) rotate(45deg)}
}

.case-card-content{
  position:relative;
  z-index:1;
}

.case-card.daily{
  border-color:#4ade80;
  box-shadow:0 8px 30px rgba(74,222,128,0.35);
}

.case-card.starter{
  border-color:#8b7355;
  box-shadow:0 8px 30px rgba(139,115,85,0.35);
}

.case-card.bronze{
  border-color:#cd7f32;
  box-shadow:0 8px 30px rgba(205,127,50,0.35);
}

.case-card.silver{
  border-color:#c0c0c0;
  box-shadow:0 8px 30px rgba(192,192,192,0.35);
}

.case-card.gold{
  border-color:#ffd700;
  box-shadow:0 8px 30px rgba(255,215,0,0.4);
}

.case-card.platinum{
  border-color:#e5e4e2;
  box-shadow:0 8px 30px rgba(229,228,226,0.4);
}

.case-card.diamond{
  border-color:#b9f2ff;
  box-shadow:0 8px 30px rgba(185,242,255,0.45);
}

.case-card.legendary{
  border-image:linear-gradient(45deg,#ff6b6b,#ffd700,#4ecdc4,#ff6b6b) 1;
  box-shadow:0 10px 40px rgba(255,107,107,0.4);
  animation:legendaryPulse 2s ease-in-out infinite;
}

@keyframes legendaryPulse{
  0%,100%{transform:scale(1);box-shadow:0 10px 40px rgba(255,107,107,0.4)}
  50%{transform:scale(1.02);box-shadow:0 12px 50px rgba(255,215,0,0.5)}
}

.case-card:hover{
  transform:translateY(-8px) scale(1.02);
}

.case-icon{
  font-size:64px;
  margin-bottom:12px;
  filter:drop-shadow(0 0 15px currentColor);
}

.case-name{
  font-size:22px;
  font-weight:700;
  margin-bottom:10px;
  font-family:'Poppins',sans-serif;
  text-shadow:0 0 12px currentColor;
  color:#e0e0e0;
}

.case-price{
  font-size:18px;
  color:#fff;
  margin:10px 0;
  font-weight:700;
}

.case-price-options{
  display:flex;
  gap:8px;
  justify-content:center;
  margin-top:10px;
  flex-wrap:wrap;
}

.price-option{
  background:rgba(0,0,0,0.5);
  padding:6px 10px;
  border-radius:8px;
  font-size:12px;
  border:1px solid rgba(255,255,255,0.2);
}

.case-rewards{
  font-size:13px;
  color:#bbb;
  margin-top:10px;
}

.nav-menu{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:rgba(20,20,30,0.95);
  backdrop-filter:blur(20px);
  border-top:2px solid rgba(200,200,200,0.3);
  padding:8px;
  z-index:100;
  display:flex;
  gap:6px;
  justify-content:center;
  overflow-x:auto;
  overflow-y:hidden;
}

.nav-item{
  background:rgba(200,200,200,0.15);
  border:2px solid rgba(200,200,200,0.4);
  color:#d0d0d0;
  padding:10px 14px;
  border-radius:12px;
  font-size:12px;
  font-weight:700;
  white-space:nowrap;
  cursor:pointer;
  transition:all 0.3s;
  flex-shrink:0;
}

.nav-item.active{
  background:linear-gradient(135deg,rgba(255,255,255,0.3),rgba(220,220,220,0.3));
  border-color:#e0e0e0;
  color:#fff;
  box-shadow:0 5px 20px rgba(224,224,224,0.5);
}

.nav-item:active{
  transform:scale(0.95);
}

.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.95);
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:999;
  backdrop-filter:blur(10px);
  overflow-y:auto;
  padding:20px;
}

.popup.active{display:flex}

.popup-content{
  background:linear-gradient(135deg,rgba(60,40,80,0.95),rgba(40,60,80,0.95));
  border:3px solid rgba(200,200,200,0.5);
  border-radius:25px;
  padding:30px;
  text-align:center;
  max-width:90%;
  animation:popIn 0.5s cubic-bezier(0.68,-0.55,0.265,1.55);
  box-shadow:0 20px 60px rgba(200,200,200,0.3);
  max-height:90vh;
  overflow-y:auto;
}

@keyframes popIn{
  0%{transform:scale(0) rotate(-180deg);opacity:0}
  100%{transform:scale(1) rotate(0deg);opacity:1}
}

.popup-title{
  font-size:32px;
  color:#e0e0e0;
  margin-bottom:20px;
  font-family:'Poppins',sans-serif;
  text-shadow:0 0 30px rgba(224,224,224,0.8);
  letter-spacing:2px;
}

.popup-reward{
  font-size:56px;
  color:#fff;
  margin:25px 0;
  font-weight:bold;
  text-shadow:0 0 40px rgba(255,255,255,1);
  font-family:'Poppins',sans-serif;
  animation:rewardPulse 1s ease-in-out infinite;
}

@keyframes rewardPulse{
  0%,100%{transform:scale(1)}
  50%{transform:scale(1.1)}
}

.popup-btn{
  background:linear-gradient(135deg,#b8b8b8,#888);
  color:#fff;
  border:none;
  padding:14px 32px;
  border-radius:15px;
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
  margin:8px;
  box-shadow:0 8px 25px rgba(180,180,180,0.4);
  transition:all 0.3s;
  font-family:'Poppins',sans-serif;
}

.popup-btn:active{
  transform:scale(0.92);
}

.popup-btn:hover{
  box-shadow:0 12px 35px rgba(180,180,180,0.6);
}

.case-reel{
  width:100%;
  max-width:350px;
  height:120px;
  background:rgba(0,0,0,0.8);
  border:3px solid rgba(200,200,200,0.5);
  border-radius:15px;
  margin:20px auto;
  overflow:hidden;
  position:relative;
}

.case-reel-items{
  display:flex;
  position:absolute;
  left:0;
  top:0;
  height:100%;
  transition:left 3s cubic-bezier(0.25,0.1,0.25,1);
}

.case-reel-item{
  min-width:100px;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:48px;
  border-right:2px solid rgba(200,200,200,0.2);
}

.case-reel-pointer{
  position:absolute;
  left:50%;
  top:0;
  bottom:0;
  width:3px;
  background:#fff;
  transform:translateX(-50%);
  box-shadow:0 0 20px rgba(255,255,255,1);
  z-index:10;
}

.mines-grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:8px;
  margin:20px 0;
  max-width:300px;
  margin:20px auto;
}

.mine-cell{
  aspect-ratio:1;
  background:linear-gradient(135deg,rgba(200,200,200,0.2),rgba(255,255,255,0.2));
  border:2px solid rgba(200,200,200,0.4);
  border-radius:10px;
  cursor:pointer;
  transition:all 0.3s;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:32px;
}

.mine-cell:hover{
  transform:scale(1.05);
  box-shadow:0 5px 20px rgba(200,200,200,0.5);
}

.mine-cell.revealed{
  cursor:default;
  opacity:0.7;
}

.mine-cell.gem{
  background:linear-gradient(135deg,rgba(200,200,200,0.4),rgba(0,200,255,0.4));
  border-color:#ccc;
}

.mine-cell.bomb{
  background:linear-gradient(135deg,rgba(255,255,255,0.4),rgba(255,100,0,0.4));
  border-color:#fff;
  animation:explode 0.5s ease-out;
}

@keyframes explode{
  0%{transform:scale(1)}
  50%{transform:scale(1.3)}
  100%{transform:scale(1)}
}

.coin-container{
  perspective:1000px;
  margin:30px auto;
}

.coin{
  width:150px;
  height:150px;
  position:relative;
  transform-style:preserve-3d;
  transition:transform 2s;
  margin:0 auto;
}

.coin-side{
  position:absolute;
  width:100%;
  height:100%;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:64px;
  backface-visibility:hidden;
  border:4px solid;
}

.coin-heads{
  background:linear-gradient(135deg,#ffd700,#ffed4e);
  border-color:#fff;
  box-shadow:0 0 40px rgba(255,255,255,0.6);
}

.coin-tails{
  background:linear-gradient(135deg,#ccc,#00ff64);
  border-color:#ccc;
  transform:rotateY(180deg);
  box-shadow:0 0 40px rgba(200,200,200,0.6);
}

.coin.flipping{
  animation:coinFlip 2s ease-out;
}

@keyframes coinFlip{
  0%{transform:rotateY(0deg)}
  100%{transform:rotateY(1800deg)}
}

.choice-buttons{
  display:flex;
  gap:15px;
  justify-content:center;
  margin:20px 0;
}

.choice-btn{
  padding:15px 30px;
  border-radius:15px;
  border:3px solid;
  font-size:18px;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s;
  font-family:'Poppins',sans-serif;
}

.choice-btn.heads{
  background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,255,255,0.2));
  border-color:#fff;
  color:#fff;
}

.choice-btn.tails{
  background:linear-gradient(135deg,rgba(200,200,200,0.2),rgba(0,255,100,0.2));
  border-color:#ccc;
  color:#ccc;
}

.choice-btn:hover{
  transform:scale(1.05);
  box-shadow:0 8px 30px currentColor;
}

.choice-btn.selected{
  background:linear-gradient(135deg,currentColor,currentColor);
  color:#000;
}

.bet-input-group{
  margin:20px 0;
}

.bet-input{
  width:100%;
  max-width:250px;
  padding:15px;
  background:rgba(0,0,0,0.6);
  border:2px solid rgba(200,200,200,0.4);
  border-radius:12px;
  color:#fff;
  font-size:20px;
  font-weight:700;
  text-align:center;
  font-family:'Poppins',sans-serif;
  margin:0 auto;
  display:block;
}

.bet-input:focus{
  outline:none;
  border-color:#ccc;
  box-shadow:0 0 20px rgba(200,200,200,0.5);
}

.bet-presets{
  display:flex;
  gap:10px;
  justify-content:center;
  margin-top:10px;
  flex-wrap:wrap;
}

.bet-preset{
  padding:8px 16px;
  background:rgba(200,200,200,0.15);
  border:2px solid rgba(200,200,200,0.4);
  border-radius:10px;
  color:#d0d0d0;
  cursor:pointer;
  transition:all 0.3s;
  font-weight:700;
}

.bet-preset:hover{
  background:rgba(200,200,200,0.2);
  transform:scale(1.05);
}

input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: rgba(0,0,0,0.6);
  border-radius: 10px;
  height: 8px;
  outline: none;
  border: 2px solid rgba(200,200,200,0.3);
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: linear-gradient(135deg, #b8b8b8, #888);
  cursor: pointer;
  border-radius: 50%;
  box-shadow: 0 0 10px rgba(200,200,200,0.5);
}

input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: linear-gradient(135deg, #b8b8b8, #888);
  cursor: pointer;
  border-radius: 50%;
  border: none;
  box-shadow: 0 0 10px rgba(200,200,200,0.5);
}

input[type="range"]::-webkit-slider-thumb:hover {
  background: linear-gradient(135deg, #d0d0d0, #a0a0a0);
  box-shadow: 0 0 15px rgba(200,200,200,0.8);
}

input[type="range"]::-moz-range-thumb:hover {
  background: linear-gradient(135deg, #d0d0d0, #a0a0a0);
  box-shadow: 0 0 15px rgba(200,200,200,0.8);
}

.task-list{
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-top:15px;
}

.task-item{
  background:linear-gradient(135deg,rgba(60,40,80,0.8),rgba(40,60,80,0.8));
  border:2px solid rgba(200,200,200,0.3);
  border-radius:15px;
  padding:18px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  transition:all 0.3s;
}

.task-item:hover{
  border-color:rgba(200,200,200,0.6);
  box-shadow:0 8px 30px rgba(200,200,200,0.3);
}

.task-info{
  flex:1;
}

.task-title{
  font-size:16px;
  font-weight:700;
  color:#e0e0e0;
  margin-bottom:5px;
}

.task-reward{
  font-size:14px;
  color:#fff;
}

.task-btn{
  padding:10px 20px;
  background:linear-gradient(135deg,#b8b8b8,#888);
  border:none;
  border-radius:10px;
  color:#fff;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s;
}

.task-btn:hover{
  transform:scale(1.05);
  box-shadow:0 5px 20px rgba(180,180,180,0.4);
}

.task-btn.completed{
  background:#333;
  color:#666;
  cursor:default;
}

.leaderboard-list{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-top:15px;
}

.leaderboard-item{
  background:rgba(30,30,40,0.8);
  border:2px solid rgba(200,200,200,0.2);
  border-radius:12px;
  padding:15px;
  display:flex;
  align-items:center;
  gap:15px;
}

.leaderboard-rank{
  font-size:24px;
  font-weight:700;
  color:#fff;
  min-width:40px;
  font-family:'Poppins',sans-serif;
}

.leaderboard-info{
  flex:1;
}

.leaderboard-name{
  font-size:16px;
  font-weight:700;
  color:#fff;
}

.leaderboard-score{
  font-size:14px;
  color:#ccc;
}

.leaderboard-item.current{
  border-color:#e0e0e0;
  background:rgba(224,224,224,0.1);
  box-shadow:0 5px 20px rgba(224,224,224,0.3);
}

.filter-btn{
  background:rgba(200,200,200,0.15);
  border:2px solid rgba(200,200,200,0.4);
  color:#d0d0d0;
  padding:10px 16px;
  border-radius:12px;
  font-size:13px;
  font-weight:700;
  white-space:nowrap;
  cursor:pointer;
  transition:all 0.3s;
  flex-shrink:0;
}

.filter-btn.active{
  background:linear-gradient(135deg,rgba(255,255,255,0.3),rgba(220,220,220,0.3));
  border-color:#e0e0e0;
  color:#fff;
  box-shadow:0 5px 20px rgba(224,224,224,0.5);
}

.filter-btn:active{
  transform:scale(0.95);
}

.deposit-options{
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-top:20px;
}

.deposit-option{
  background:rgba(30,30,40,0.8);
  border:2px solid rgba(200,200,200,0.3);
  border-radius:15px;
  padding:20px;
}

.deposit-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}

.deposit-currency{
  font-size:18px;
  font-weight:700;
  color:#e0e0e0;
}

.deposit-address{
  background:rgba(0,0,0,0.6);
  border:2px solid rgba(200,200,200,0.3);
  border-radius:10px;
  padding:10px;
  margin-top:10px;
  font-size:12px;
  color:#ccc;
  word-break:break-all;
  font-family:monospace;
}

.copy-btn{
  background:linear-gradient(135deg,#b8b8b8,#888);
  border:none;
  padding:8px 16px;
  border-radius:8px;
  color:#fff;
  font-weight:700;
  cursor:pointer;
  margin-top:8px;
  font-size:12px;
}

.shop-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:15px;
  margin-top:20px;
}

.shop-item{
  background:linear-gradient(135deg,rgba(60,40,80,0.8),rgba(40,60,80,0.8));
  border:2px solid rgba(200,200,200,0.3);
  border-radius:15px;
  padding:20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.shop-info{
  flex:1;
}

.shop-title{
  font-size:18px;
  font-weight:700;
  color:#e0e0e0;
  margin-bottom:5px;
}

.shop-description{
  font-size:14px;
  color:#ccc;
  margin-bottom:8px;
}

.shop-price{
  font-size:16px;
  color:#4ade80;
  font-weight:700;
}

.shop-btn{
  padding:12px 24px;
  background:linear-gradient(135deg,#b8b8b8,#888);
  border:none;
  border-radius:10px;
  color:#fff;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s;
}

.shop-btn:hover{
  transform:scale(1.05);
  box-shadow:0 5px 20px rgba(180,180,180,0.4);
}

.shop-btn.owned{
  background:#4ade80;
  cursor:default;
}

.shop-btn.equipped{
  background:#333;
  color:#4ade80;
  cursor:default;
}

.welcome-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.98);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:10000;
  backdrop-filter:blur(10px);
}

.welcome-content{
  max-width:400px;
  padding:40px;
  text-align:center;
  animation:fadeIn 1s ease-out;
}

.welcome-logo{
  font-size:64px;
  font-weight:900;
  background:linear-gradient(135deg,#fff 0%,#e0e0e0 50%,#fff 100%);
  background-size:200%;
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
  animation:logoGlow 3s ease infinite;
  letter-spacing:8px;
  margin-bottom:30px;
}

.welcome-text{
  font-size:18px;
  color:#e0e0e0;
  line-height:1.6;
  margin-bottom:30px;
}

.welcome-btn{
  background:linear-gradient(135deg,#b8b8b8,#888);
  color:#fff;
  border:none;
  padding:16px 40px;
  border-radius:20px;
  font-size:18px;
  font-weight:bold;
  cursor:pointer;
  box-shadow:0 10px 30px rgba(180,180,180,0.5);
  transition:all 0.3s;
  font-family:'Poppins',sans-serif;
}

.welcome-btn:hover{
  transform:translateY(-3px);
  box-shadow:0 15px 40px rgba(180,180,180,0.6);
}
</style>
</head>
<body>

<!-- Welcome Screen -->
<div class="welcome-overlay" id="welcomeScreen">
  <div class="welcome-content">
    <div class="welcome-logo">BERON</div>
    <div class="welcome-text">
      Welcome to Beron - the ultimate crypto clicker game!
      <br><br>
      Tap to earn coins, complete tasks, open cases, and climb the leaderboard.
      <br><br>
      Build your empire and compete with players worldwide!
    </div>
    <button class="welcome-btn" onclick="closeWelcome()">START PLAYING</button>
  </div>
</div>

<div class="app">
<div class="animated-bg"></div>
<div class="scan-lines"></div>

<div class="content">
<div class="header">
  <div class="logo">BERON</div>
</div>

<!-- MAIN TAB -->
<div class="tab-content active" id="mainTab">
  <div class="stats-box">
    <div class="coins" id="coins">$0</div>
    <div class="passive-income" id="passiveIncome">+0/sec</div>
    <div class="currency-grid">
      <div class="currency-item">
        <div class="currency-label">BER Token</div>
        <div class="currency-value" id="tokens">0</div>
      </div>
      <div class="currency-item">
        <div class="currency-label">BER Stars</div>
        <div class="currency-value" id="stars">0</div>
      </div>
      <div class="currency-item">
        <div class="currency-label">BER Tons</div>
        <div class="currency-value" id="bertons">0</div>
      </div>
      <div class="currency-item">
        <div class="currency-label">Level</div>
        <div class="currency-value" id="level">1</div>
      </div>
    </div>
    <div class="rank-badge" id="rank">Bronze</div>
    <div class="energy-bar">
      <div class="energy-fill" id="energyBar" style="width:100%"></div>
    </div>
    <div style="font-size:13px;color:#ccc;margin-top:8px;text-align:center;font-weight:600">Energy: <span id="energyText">1000/1000</span></div>
  </div>

  <div class="tap-section">
    <button class="tap-btn" id="tapBtn">
      <div class="tap-btn-content">
        <div class="tap-btn-skin" id="tapSkin">üëÜ</div>
        <div class="tap-btn-text">TAP</div>
      </div>
    </button>
  </div>

  <div class="quick-actions">
    <button class="action-btn" onclick="showExchange()">üíé Exchange</button>
    <button class="action-btn" onclick="showDeposit()">üí∞ Deposit</button>
    <button class="action-btn" onclick="showWithdraw()">üè¶ Withdraw</button>
    <button class="action-btn" onclick="exchangeAllTokens()">‚ö° All‚ÜíBER</button>
  </div>

  <div class="section-title">üéÆ MINI GAMES</div>
  <div class="games-grid">
    <div class="game-card" onclick="startDropGame()">
      <div class="game-icon">‚≠ê</div>
      <div class="game-name">Drop Game</div>
    </div>
    <div class="game-card" onclick="startSnakeGame()">
      <div class="game-icon">üêç</div>
      <div class="game-name">Snake</div>
    </div>
    <div class="game-card" onclick="showMinesGame()">
      <div class="game-icon">üí£</div>
      <div class="game-name">Minesweeper</div>
    </div>
    <div class="game-card" onclick="showCoinFlip()">
      <div class="game-icon">ü™ô</div>
      <div class="game-name">Coin Flip</div>
    </div>
  </div>
</div>

<!-- CASES TAB -->
<div class="tab-content" id="casesTab">
  <div class="section-title" style="margin-top:20px">üé∞ CASES</div>
  <div class="cases-grid">
    <div class="case-card daily" onclick="openDailyCase()">
      <div class="case-card-content">
        <div class="case-icon">üéÅ</div>
        <div class="case-name">Daily Case</div>
        <div class="case-price">FREE (24h)</div>
        <div class="case-rewards">Win: $50 - $500</div>
      </div>
    </div>
    
    <div class="case-card starter" onclick="showCaseOptions('starter')">
      <div class="case-card-content">
        <div class="case-icon">üì¶</div>
        <div class="case-name">Starter Case</div>
        <div class="case-price-options">
          <div class="price-option">üí∞ $500</div>
          <div class="price-option">‚≠ê 50</div>
        </div>
        <div class="case-rewards">Win: $200 - $2,000</div>
      </div>
    </div>
    
    <div class="case-card bronze" onclick="showCaseOptions('bronze')">
      <div class="case-card-content">
        <div class="case-icon">ü•â</div>
        <div class="case-name">Bronze Case</div>
        <div class="case-price-options">
          <div class="price-option">üí∞ $2,000</div>
          <div class="price-option">‚≠ê 200</div>
        </div>
        <div class="case-rewards">Win: $1,000 - $8,000</div>
      </div>
    </div>
    
    <div class="case-card silver" onclick="showCaseOptions('silver')">
      <div class="case-card-content">
        <div class="case-icon">ü•à</div>
        <div class="case-name">Silver Case</div>
        <div class="case-price-options">
          <div class="price-option">üí∞ $10,000</div>
          <div class="price-option">‚≠ê 1,000</div>
          <div class="price-option">üî• 100</div>
        </div>
        <div class="case-rewards">Win: $5,000 - $30,000</div>
      </div>
    </div>
    
    <div class="case-card gold" onclick="showCaseOptions('gold')">
      <div class="case-card-content">
        <div class="case-icon">ü•á</div>
        <div class="case-name">Gold Case</div>
        <div class="case-price-options">
          <div class="price-option">üí∞ $50,000</div>
          <div class="price-option">‚≠ê 5,000</div>
          <div class="price-option">üî• 500</div>
        </div>
        <div class="case-rewards">Win: $25,000 - $150,000</div>
      </div>
    </div>

    <div class="case-card platinum" onclick="showCaseOptions('platinum')">
      <div class="case-card-content">
        <div class="case-icon">üíø</div>
        <div class="case-name">Platinum Case</div>
        <div class="case-price-options">
          <div class="price-option">üí∞ $200,000</div>
          <div class="price-option">‚≠ê 20,000</div>
          <div class="price-option">üî• 2,000</div>
        </div>
        <div class="case-rewards">Win: $100,000 - $500,000</div>
      </div>
    </div>

    <div class="case-card diamond" onclick="showCaseOptions('diamond')">
      <div class="case-card-content">
        <div class="case-icon">üíé</div>
        <div class="case-name">Diamond Case</div>
        <div class="case-price-options">
          <div class="price-option">üí∞ $1,000,000</div>
          <div class="price-option">‚≠ê 100,000</div>
          <div class="price-option">üî• 10,000</div>
        </div>
        <div class="case-rewards">Win: $500,000 - $2,000,000</div>
      </div>
    </div>

    <div class="case-card legendary" onclick="showCaseOptions('legendary')">
      <div class="case-card-content">
        <div class="case-icon">üåü</div>
        <div class="case-name">Legendary Case</div>
        <div class="case-price-options">
          <div class="price-option">üí∞ $5,000,000</div>
          <div class="price-option">‚≠ê 500,000</div>
          <div class="price-option">üî• 50,000</div>
        </div>
        <div class="case-rewards">Win: $2,500,000 - $10,000,000</div>
      </div>
    </div>
  </div>
</div>

<!-- TASKS TAB -->
<div class="tab-content" id="tasksTab">
  <div class="section-title" style="margin-top:20px">üìã TASKS</div>
  
  <div style="background:linear-gradient(135deg,rgba(60,40,80,0.8),rgba(40,60,80,0.8));border:2px solid rgba(200,200,200,0.3);border-radius:15px;padding:20px;margin:15px 0;text-align:center">
    <div style="font-size:14px;color:#ccc;margin-bottom:8px">Total Earned from Tasks</div>
    <div style="font-size:32px;font-weight:bold;color:#4ade80;text-shadow:0 0 20px rgba(74,222,128,0.8)" id="totalTaskEarnings">$0</div>
  </div>
  
  <h3 style="color:#e0e0e0;margin:25px 0 10px 10px;font-size:18px">‚ö° Daily Tasks</h3>
  <div style="font-size:13px;color:#999;margin:0 0 10px 10px">Reset in: <span id="dailyTaskReset">--:--:--</span></div>
  <div class="task-list" id="dailyTaskList"></div>
  
  <h3 style="color:#e0e0e0;margin:25px 0 10px 10px;font-size:18px">üåü Social Tasks</h3>
  <div class="task-list" id="socialTaskList"></div>
  
  <h3 style="color:#e0e0e0;margin:25px 0 10px 10px;font-size:18px">üéØ Achievement Tasks</h3>
  <div class="task-list" id="achievementTaskList"></div>
  
  <h3 style="color:#e0e0e0;margin:25px 0 10px 10px;font-size:18px">üíé Special Tasks</h3>
  <div class="task-list" id="specialTaskList"></div>
</div>

<!-- SHOP TAB -->
<div class="tab-content" id="shopTab">
  <div class="section-title" style="margin-top:20px">üè™ SHOP</div>
  
  <h3 style="color:#e0e0e0;margin:20px 0 10px 10px;font-size:20px">üíé Tap Skins</h3>
  <div class="shop-grid" id="skinShop"></div>
  
  <h3 style="color:#e0e0e0;margin:30px 0 10px 10px;font-size:20px">‚ö° Upgrades</h3>
  <div class="shop-grid" id="upgradeShop"></div>
</div>

<!-- LEADERBOARD TAB -->
<div class="tab-content" id="leaderboardTab">
  <div class="section-title" style="margin-top:20px">üèÜ LEADERBOARD</div>
  
  <div style="background:linear-gradient(135deg,rgba(60,40,80,0.8),rgba(40,60,80,0.8));border:2px solid rgba(200,200,200,0.3);border-radius:15px;padding:20px;margin:15px 0;text-align:center">
    <div style="font-size:14px;color:#ccc;margin-bottom:8px">Your Position</div>
    <div style="font-size:36px;font-weight:bold;color:#fff;text-shadow:0 0 20px rgba(255,255,255,0.8)" id="userRank">#...</div>
    <div style="font-size:14px;color:#4ade80;margin-top:8px" id="userScore">$0</div>
  </div>
  
  <div style="display:flex;gap:10px;margin:15px 0;overflow-x:auto">
    <button class="filter-btn active" onclick="filterLeaderboard('all')" data-filter="all">üåç All Time</button>
    <button class="filter-btn" onclick="filterLeaderboard('today')" data-filter="today">üìÖ Today</button>
    <button class="filter-btn" onclick="filterLeaderboard('week')" data-filter="week">üìä Week</button>
  </div>
  
  <div class="leaderboard-list" id="leaderboardList"></div>
</div>

<!-- PVP TAB -->
<div class="tab-content" id="pvpTab">
  <div class="section-title" style="margin-top:20px">‚öîÔ∏è PVP ARENA</div>
  <div style="text-align:center;padding:40px 20px">
    <div style="font-size:80px;margin-bottom:20px">‚öîÔ∏è</div>
    <div style="font-size:24px;color:#e0e0e0;margin-bottom:15px;font-weight:700">PVP Coming Soon!</div>
    <div style="font-size:16px;color:#999">Challenge other players and win big!</div>
  </div>
</div>

<div style="height:100px"></div>
</div>

<div class="nav-menu">
  <div class="nav-item active" onclick="switchTab('main')">üè† Main</div>
  <div class="nav-item" onclick="switchTab('cases')">üé∞ Cases</div>
  <div class="nav-item" onclick="switchTab('tasks')">üìã Tasks</div>
  <div class="nav-item" onclick="switchTab('shop')">üè™ Shop</div>
  <div class="nav-item" onclick="switchTab('leaderboard')">üèÜ Top</div>
  <div class="nav-item" onclick="switchTab('pvp')">‚öîÔ∏è PVP</div>
</div>
</div>

<!-- Popups -->
<div class="popup" id="caseSelectionPopup">
  <div class="popup-content">
    <div class="popup-title" id="caseSelectionTitle">Select Payment</div>
    <div style="display:flex;flex-direction:column;gap:15px;margin:20px 0" id="casePaymentOptions"></div>
    <button class="popup-btn" onclick="closeCaseSelection()">Cancel</button>
  </div>
</div>

<div class="popup" id="casePopup">
  <div class="popup-content">
    <div class="popup-title" id="caseTitle">üé∞ Opening Case</div>
    <div class="case-reel">
      <div class="case-reel-items" id="caseReelItems"></div>
      <div class="case-reel-pointer"></div>
    </div>
    <div class="popup-reward" id="caseReward" style="display:none">0</div>
    <button class="popup-btn" id="caseClaimBtn" onclick="closeCase()" style="display:none">Claim!</button>
  </div>
</div>

<div class="popup" id="exchangePopup">
  <div class="popup-content">
    <div class="popup-title">üíé Exchange</div>
    <div style="font-size:16px;color:#ccc;margin-bottom:20px">Convert your coins to BER Tokens</div>
    <div style="font-size:18px;margin:20px 0">$1,000 = 10 BER Token</div>
    <button class="popup-btn" onclick="exchange()">Exchange $1,000</button>
    <button class="popup-btn" onclick="closeExchange()">Cancel</button>
  </div>
</div>

<div class="popup" id="depositPopup">
  <div class="popup-content">
    <div class="popup-title">üí∞ Deposit</div>
    <div style="font-size:14px;color:#ccc;margin-bottom:15px">Send crypto to the addresses below</div>
    <div class="deposit-options">
      <div class="deposit-option">
        <div class="deposit-header">
          <div class="deposit-currency">‚≠ê BER Stars (TON)</div>
        </div>
        <div class="deposit-address" id="tonAddress">UQBeron_Stars_TON_Wallet_Address_Here</div>
        <button class="copy-btn" onclick="copyAddress('ton')">üìã Copy Address</button>
      </div>
      <div class="deposit-option">
        <div class="deposit-header">
          <div class="deposit-currency">üî• BER Tons (TON)</div>
        </div>
        <div class="deposit-address" id="tonsAddress">UQBeron_Tons_TON_Wallet_Address_Here</div>
        <button class="copy-btn" onclick="copyAddress('tons')">üìã Copy Address</button>
      </div>
    </div>
    <div style="font-size:12px;color:#999;margin-top:15px;text-align:center">Deposits are credited automatically after confirmation</div>
    <button class="popup-btn" onclick="closeDeposit()" style="margin-top:20px">Close</button>
  </div>
</div>

<div class="popup" id="withdrawPopup">
  <div class="popup-content">
    <div class="popup-title">üí∞ Withdraw</div>
    <div style="font-size:56px;margin:30px 0;color:#fff;font-weight:bold;font-family:'Poppins',sans-serif;text-shadow:0 0 40px rgba(255,255,255,1)">SOON!</div>
    <div style="font-size:18px;color:#ccc;margin-bottom:20px">Feature coming soon...</div>
    <button class="popup-btn" onclick="closeWithdraw()">OK</button>
  </div>
</div>

<div class="popup" id="minesPopup">
  <div class="popup-content" style="max-width:400px">
    <div class="popup-title">üíé Mines Game</div>
    <div style="font-size:16px;color:#ccc;margin-bottom:15px">Find gems, avoid bombs!</div>
    <div class="bet-input-group">
      <input type="number" class="bet-input" id="minesBet" placeholder="Enter bet amount">
      <div class="bet-presets">
        <div class="bet-preset" onclick="setMinesBet(100)">$100</div>
        <div class="bet-preset" onclick="setMinesBet(500)">$500</div>
        <div class="bet-preset" onclick="setMinesBet(1000)">$1,000</div>
        <div class="bet-preset" onclick="setMinesBet(5000)">$5,000</div>
      </div>
    </div>
    <div style="margin:15px 0">
      <div style="font-size:14px;color:#ccc;margin-bottom:8px">Number of Mines:</div>
      <input type="range" id="minesCount" min="3" max="24" value="7" style="width:100%;max-width:250px" oninput="updateMineCount()">
      <div style="font-size:18px;color:#fff;font-weight:700;margin-top:5px"><span id="mineCountDisplay">7</span> üí£</div>
    </div>
    <button class="popup-btn" onclick="startMinesGame()" id="minesStartBtn">Start Game</button>
    <div id="minesGameArea" style="display:none">
      <div style="font-size:18px;color:#fff;margin:15px 0;font-weight:700">Current: $<span id="minesCurrentWin">0</span></div>
      <div class="mines-grid" id="minesGrid"></div>
      <button class="popup-btn" onclick="cashoutMines()" id="minesCashoutBtn">Cash Out</button>
      <button class="popup-btn" onclick="closeMinesGame()">Exit</button>
    </div>
    <button class="popup-btn" onclick="closeMinesGame()" id="minesCloseBtn">Close</button>
  </div>
</div>

<div class="popup" id="coinFlipPopup">
  <div class="popup-content" style="max-width:400px">
    <div class="popup-title">ü™ô Coin Flip</div>
    <div style="font-size:16px;color:#ccc;margin-bottom:15px">Choose heads or tails! x1.95 payout</div>
    <div class="bet-input-group">
      <input type="number" class="bet-input" id="coinBet" placeholder="Enter bet amount">
      <div class="bet-presets">
        <div class="bet-preset" onclick="setCoinBet(100)">$100</div>
        <div class="bet-preset" onclick="setCoinBet(500)">$500</div>
        <div class="bet-preset" onclick="setCoinBet(1000)">$1,000</div>
        <div class="bet-preset" onclick="setCoinBet(5000)">$5,000</div>
      </div>
    </div>
    <div class="choice-buttons" id="coinChoices">
      <button class="choice-btn heads" onclick="selectCoinSide('heads')">üî¥ HEADS</button>
      <button class="choice-btn tails" onclick="selectCoinSide('tails')">üü¢ TAILS</button>
    </div>
    <button class="popup-btn" onclick="flipCoin()" id="coinFlipBtn" style="display:none">Flip Coin!</button>
    <div class="coin-container" id="coinContainer" style="display:none">
      <div class="coin" id="coin">
        <div class="coin-side coin-heads">üî¥</div>
        <div class="coin-side coin-tails">üü¢</div>
      </div>
    </div>
    <div id="coinResult" style="font-size:24px;color:#fff;margin:20px 0;font-weight:700;display:none"></div>
    <button class="popup-btn" onclick="closeCoinFlip()">Close</button>
  </div>
</div>

<div class="popup" id="dropGamePopup">
  <div class="popup-content" style="max-width:400px">
    <div class="popup-title">‚≠ê Drop Game</div>
    <div style="font-size:16px;color:#ccc;margin-bottom:10px">Set your bet to play!</div>
    <div class="bet-input-group" id="dropBetArea">
      <input type="number" class="bet-input" id="dropBet" placeholder="Enter bet amount">
      <div class="bet-presets">
        <div class="bet-preset" onclick="setDropBet(100)">$100</div>
        <div class="bet-preset" onclick="setDropBet(500)">$500</div>
        <div class="bet-preset" onclick="setDropBet(1000)">$1,000</div>
      </div>
      <button class="popup-btn" onclick="startDropGameWithBet()" style="margin-top:10px">Start Game</button>
    </div>
    <div id="dropGameArea" style="display:none">
      <div style="position:relative;width:100%;max-width:350px;height:500px;background:rgba(0,0,0,0.8);border:3px solid rgba(200,200,200,0.5);border-radius:15px;margin:20px auto">
        <div style="position:absolute;top:10px;left:10px;font-size:20px;color:#fff;font-weight:bold;text-shadow:0 0 10px rgba(255,215,0,0.8);font-family:'Poppins',sans-serif;z-index:10;" id="dropTimer">00:30</div>
        <div style="position:absolute;top:10px;right:10px;font-size:20px;color:#fff;font-weight:bold;text-shadow:0 0 10px rgba(255,215,0,0.8);font-family:'Poppins',sans-serif;z-index:10;" id="dropScore">$0</div>
        <canvas id="dropGameCanvas" width="350" height="500"></canvas>
        <div id="dropGameOver" style="position:absolute;inset:0;display:none;justify-content:center;align-items:center;flex-direction:column;background:rgba(0,0,0,0.9);border-radius:15px;z-index:20">
          <div style="font-size:36px;color:#fff;margin-bottom:20px;font-family:'Poppins',sans-serif;text-shadow:0 0 20px rgba(255,255,255,0.8)">TIME'S UP!</div>
          <div style="font-size:24px;color:#fff;margin-bottom:20px">Result: $<span id="dropEarned">0</span></div>
          <button class="popup-btn" onclick="restartDropGame()">Play Again</button>
          <button class="popup-btn" onclick="closeDropGame()">Exit</button>
        </div>
      </div>
    </div>
    <button class="popup-btn" onclick="closeDropGame()" id="dropCloseBtn">Close</button>
  </div>
</div>

<div class="popup" id="snakeGamePopup">
  <div class="popup-content" style="max-width:400px">
    <div class="popup-title">üêç Snake Game</div>
    <div style="font-size:16px;color:#ccc;margin-bottom:10px">Set your bet to play!</div>
    <div class="bet-input-group" id="snakeBetArea">
      <input type="number" class="bet-input" id="snakeBet" placeholder="Enter bet amount">
      <div class="bet-presets">
        <div class="bet-preset" onclick="setSnakeBet(100)">$100</div>
        <div class="bet-preset" onclick="setSnakeBet(500)">$500</div>
        <div class="bet-preset" onclick="setSnakeBet(1000)">$1,000</div>
      </div>
      <button class="popup-btn" onclick="startSnakeGameWithBet()" style="margin-top:10px">Start Game</button>
    </div>
    <div id="snakeGameArea" style="display:none">
      <div style="position:relative;width:100%;max-width:350px;height:500px;background:rgba(0,0,0,0.8);border:3px solid rgba(200,200,200,0.5);border-radius:15px;margin:20px auto">
        <div style="position:absolute;top:10px;right:10px;font-size:20px;color:#fff;font-weight:bold;text-shadow:0 0 10px rgba(255,215,0,0.8);font-family:'Poppins',sans-serif;z-index:10;" id="snakeScore">Score: 0</div>
        <canvas id="snakeGameCanvas" width="350" height="500"></canvas>
        <div id="snakeGameOver" style="position:absolute;inset:0;display:none;justify-content:center;align-items:center;flex-direction:column;background:rgba(0,0,0,0.9);border-radius:15px;z-index:20">
          <div style="font-size:36px;color:#fff;margin-bottom:20px;font-family:'Poppins',sans-serif;text-shadow:0 0 20px rgba(255,255,255,0.8)">GAME OVER</div>
          <div style="font-size:24px;color:#fff;margin-bottom:20px">Result: $<span id="snakeEarned">0</span></div>
          <button class="popup-btn" onclick="restartSnakeGame()">Play Again</button>
          <button class="popup-btn" onclick="closeSnakeGame()">Exit</button>
        </div>
      </div>
    </div>
    <button class="popup-btn" onclick="closeSnakeGame()" id="snakeCloseBtn">Close</button>
  </div>
</div>

<script>
document.addEventListener('contextmenu', e => e.preventDefault());

// Game state
let coins = parseInt(localStorage.getItem('coins')) || 0;
let tokens = parseInt(localStorage.getItem('tokens')) || 0;
let stars = parseInt(localStorage.getItem('stars')) || 0;
let bertons = parseInt(localStorage.getItem('bertons')) || 0;
let lastDailyCase = parseInt(localStorage.getItem('lastDailyCase')) || 0;
let energy = parseInt(localStorage.getItem('energy')) || 1000;
let maxEnergy = parseInt(localStorage.getItem('maxEnergy')) || 1000;
let lastEnergyUpdate = parseInt(localStorage.getItem('lastEnergyUpdate')) || Date.now();
let level = parseInt(localStorage.getItem('level')) || 1;
let completedTasks = JSON.parse(localStorage.getItem('completedTasks')) || [];
let tapPower = parseInt(localStorage.getItem('tapPower')) || 1;
let passiveIncome = parseInt(localStorage.getItem('passiveIncome')) || 0;
let lastPassiveUpdate = parseInt(localStorage.getItem('lastPassiveUpdate')) || Date.now();
let currentSkin = localStorage.getItem('currentSkin') || 'default';
let ownedSkins = JSON.parse(localStorage.getItem('ownedSkins')) || ['default'];
let playerName = localStorage.getItem('playerName') || 'Player' + Math.floor(Math.random() * 10000);
let hasSeenWelcome = localStorage.getItem('hasSeenWelcome') === 'true';

// Skin definitions
const skins = {
  default: {emoji: 'üëÜ', name: 'Default', price: 0},
  bronze: {emoji: 'ü•â', name: 'Bronze Finger', price: 10000},
  silver: {emoji: 'ü•à', name: 'Silver Finger', price: 50000},
  gold: {emoji: 'ü•á', name: 'Gold Finger', price: 200000},
  diamond: {emoji: 'üíé', name: 'Diamond Hand', price: 1000000},
  rocket: {emoji: 'üöÄ', name: 'Rocket', price: 500000},
  fire: {emoji: 'üî•', name: 'Fire Touch', price: 750000},
  lightning: {emoji: '‚ö°', name: 'Lightning', price: 1500000}
};

// Upgrade definitions
const upgrades = {
  tapPower: [
    {level: 1, price: 5000, value: 2},
    {level: 2, price: 25000, value: 5},
    {level: 3, price: 100000, value: 10},
    {level: 4, price: 500000, value: 25},
    {level: 5, price: 2000000, value: 50}
  ],
  passiveIncome: [
    {level: 1, price: 10000, value: 1},
    {level: 2, price: 50000, value: 5},
    {level: 3, price: 200000, value: 15},
    {level: 4, price: 1000000, value: 50},
    {level: 5, price: 5000000, value: 150}
  ],
  maxEnergy: [
    {level: 1, price: 15000, value: 1500},
    {level: 2, price: 75000, value: 2000},
    {level: 3, price: 300000, value: 3000},
    {level: 4, price: 1500000, value: 5000}
  ]
};

let tapPowerLevel = parseInt(localStorage.getItem('tapPowerLevel')) || 0;
let passiveIncomeLevel = parseInt(localStorage.getItem('passiveIncomeLevel')) || 0;
let maxEnergyLevel = parseInt(localStorage.getItem('maxEnergyLevel')) || 0;

function save() {
  localStorage.setItem('coins', coins);
  localStorage.setItem('tokens', tokens);
  localStorage.setItem('stars', stars);
  localStorage.setItem('bertons', bertons);
  localStorage.setItem('lastDailyCase', lastDailyCase);
  localStorage.setItem('energy', energy);
  localStorage.setItem('maxEnergy', maxEnergy);
  localStorage.setItem('lastEnergyUpdate', lastEnergyUpdate);
  localStorage.setItem('level', level);
  localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
  localStorage.setItem('tapPower', tapPower);
  localStorage.setItem('passiveIncome', passiveIncome);
  localStorage.setItem('lastPassiveUpdate', lastPassiveUpdate);
  localStorage.setItem('currentSkin', currentSkin);
  localStorage.setItem('ownedSkins', JSON.stringify(ownedSkins));
  localStorage.setItem('playerName', playerName);
  localStorage.setItem('tapPowerLevel', tapPowerLevel);
  localStorage.setItem('passiveIncomeLevel', passiveIncomeLevel);
  localStorage.setItem('maxEnergyLevel', maxEnergyLevel);
  localStorage.setItem('hasSeenWelcome', 'true');
}

function updateUI() {
  document.getElementById('coins').innerText = '$' + coins.toLocaleString();
  document.getElementById('tokens').innerText = tokens.toLocaleString();
  document.getElementById('stars').innerText = stars.toLocaleString();
  document.getElementById('bertons').innerText = bertons.toLocaleString();
  document.getElementById('level').innerText = level;
  document.getElementById('passiveIncome').innerText = '+' + passiveIncome + '/sec';
  
  let rank = 'Bronze';
  if (coins > 1000000) rank = 'Diamond üíé';
  else if (coins > 500000) rank = 'Platinum ‚ö™';
  else if (coins > 100000) rank = 'Gold ü•á';
  else if (coins > 10000) rank = 'Silver ü•à';
  else rank = 'Bronze ü•â';
  document.getElementById('rank').innerText = rank;
  
  const energyPercent = Math.min(100, (energy / maxEnergy) * 100);
  document.getElementById('energyBar').style.width = energyPercent + '%';
  document.getElementById('energyText').innerText = energy + '/' + maxEnergy;
  
  document.getElementById('tapSkin').innerText = skins[currentSkin].emoji;
}

// Welcome screen
function closeWelcome() {
  document.getElementById('welcomeScreen').style.display = 'none';
  save();
}

if (hasSeenWelcome) {
  document.getElementById('welcomeScreen').style.display = 'none';
}

// TAB SWITCHING
function switchTab(tab) {
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  
  const tabs = {
    main: [document.getElementById('mainTab'), 0],
    cases: [document.getElementById('casesTab'), 1],
    tasks: [document.getElementById('tasksTab'), 2],
    shop: [document.getElementById('shopTab'), 3],
    leaderboard: [document.getElementById('leaderboardTab'), 4],
    pvp: [document.getElementById('pvpTab'), 5]
  };
  
  if (tabs[tab]) {
    tabs[tab][0].classList.add('active');
    document.querySelectorAll('.nav-item')[tabs[tab][1]].classList.add('active');
    
    if (tab === 'tasks') loadTasks();
    if (tab === 'leaderboard') loadLeaderboard();
    if (tab === 'shop') loadShop();
  }
}

// Energy regeneration (1 per second)
setInterval(() => {
  const now = Date.now();
  const elapsed = now - lastEnergyUpdate;
  const regenAmount = Math.floor(elapsed / 1000);
  
  if (regenAmount > 0 && energy < maxEnergy) {
    energy = Math.min(maxEnergy, energy + regenAmount);
    lastEnergyUpdate = now;
    save();
    updateUI();
  }
}, 1000);

// Passive income
setInterval(() => {
  if (passiveIncome > 0) {
    const now = Date.now();
    const elapsed = now - lastPassiveUpdate;
    const earnedAmount = Math.floor((elapsed / 1000) * passiveIncome);
    
    if (earnedAmount > 0) {
      coins += earnedAmount;
      lastPassiveUpdate = now;
      save();
      updateUI();
    }
  }
}, 1000);

updateUI();

// TAP SYSTEM
const tapBtn = document.getElementById('tapBtn');
let lastTap = 0;
let tapCombo = 0;
let comboTimer;

tapBtn.addEventListener('touchstart', handleTap);
tapBtn.addEventListener('click', handleTap);

function handleTap(e) {
  e.preventDefault();
  
  const now = Date.now();
  if (now - lastTap < 50) {
    tapBtn.classList.add('cooldown');
    setTimeout(() => tapBtn.classList.remove('cooldown'), 200);
    return;
  }
  
  if (energy <= 0) {
    showFloatingText('No energy!', e.touches?.[0]?.clientX || e.clientX, e.touches?.[0]?.clientY || e.clientY);
    return;
  }
  
  lastTap = now;
  energy = Math.max(0, energy - 1);
  
  let crit = Math.random();
  let gain = tapPower;
  let critText = '';
  
  if (crit > 0.98) {
    gain *= 100;
    critText = ' üí•MEGA!';
  } else if (crit > 0.95) {
    gain *= 50;
    critText = ' ‚ö°SUPER!';
  } else if (crit > 0.85) {
    gain *= 10;
    critText = ' ‚ú®CRIT!';
  }
  
  clearTimeout(comboTimer);
  tapCombo++;
  comboTimer = setTimeout(() => tapCombo = 0, 2000);
  
  if (tapCombo > 10) gain *= 2;
  if (tapCombo > 20) gain *= 3;
  
  const oldCoins = coins;
  coins += gain;
  
  // Track taps for tasks
  const totalTaps = (parseInt(localStorage.getItem('totalTaps')) || 0) + 1;
  localStorage.setItem('totalTaps', totalTaps);
  updateDailyTaskProgress('tap', 1);
  updateDailyTaskProgress('earn', gain);
  
  // Level up system
  const oldLevel = level;
  const newLevel = Math.floor(coins / 10000) + 1;
  if (newLevel > level) {
    level = newLevel;
    updateDailyTaskProgress('level', newLevel - oldLevel);
    showFloatingText('LEVEL UP! ' + level, window.innerWidth/2, window.innerHeight/2);
  }
  
  save();
  updateUI();
  
  const x = e.touches?.[0]?.clientX || e.clientX;
  const y = e.touches?.[0]?.clientY || e.clientY;
  showFloatingText('+' + gain + critText, x, y);
}

function showFloatingText(text, x, y) {
  const el = document.createElement('div');
  el.className = 'click-effect';
  el.innerText = text;
  el.style.left = x + 'px';
  el.style.top = y + 'px';
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 1200);
}

// DAILY CASE
function openDailyCase() {
  const now = Date.now();
  if (now - lastDailyCase < 86400000) {
    const timeLeft = 86400000 - (now - lastDailyCase);
    const hours = Math.floor(timeLeft / 3600000);
    const mins = Math.floor((timeLeft % 3600000) / 60000);
    alert(`Daily Case available in ${hours}h ${mins}m`);
    return;
  }
  
  lastDailyCase = now;
  save();
  
  const rewards = [500, 400, 300, 200, 150, 100, 50];
  openCaseAnimation('üéÅ Daily Case', rewards, 'coins');
}

// CASE OPTIONS
let currentCaseType = '';

function showCaseOptions(type) {
  currentCaseType = type;
  const popup = document.getElementById('caseSelectionPopup');
  const title = document.getElementById('caseSelectionTitle');
  const options = document.getElementById('casePaymentOptions');
  
  const caseConfigs = {
    starter: {
      name: 'üì¶ Starter Case',
      payments: [
        {type: 'coins', amount: 500, label: 'üí∞ $500'},
        {type: 'stars', amount: 50, label: '‚≠ê 50 Stars'}
      ],
      rewards: [2000, 1500, 1200, 1000, 800, 600, 400, 200]
    },
    bronze: {
      name: 'ü•â Bronze Case',
      payments: [
        {type: 'coins', amount: 2000, label: 'üí∞ $2,000'},
        {type: 'stars', amount: 200, label: '‚≠ê 200 Stars'}
      ],
      rewards: [8000, 6000, 5000, 4000, 3000, 2500, 2000, 1000]
    },
    silver: {
      name: 'ü•à Silver Case',
      payments: [
        {type: 'coins', amount: 10000, label: 'üí∞ $10,000'},
        {type: 'stars', amount: 1000, label: '‚≠ê 1,000 Stars'},
        {type: 'bertons', amount: 100, label: 'üî• 100 Tons'}
      ],
      rewards: [30000, 25000, 20000, 15000, 12000, 10000, 8000, 5000]
    },
    gold: {
      name: 'ü•á Gold Case',
      payments: [
        {type: 'coins', amount: 50000, label: 'üí∞ $50,000'},
        {type: 'stars', amount: 5000, label: '‚≠ê 5,000 Stars'},
        {type: 'bertons', amount: 500, label: 'üî• 500 Tons'}
      ],
      rewards: [150000, 125000, 100000, 80000, 70000, 60000, 50000, 25000]
    },
    platinum: {
      name: 'üíø Platinum Case',
      payments: [
        {type: 'coins', amount: 200000, label: 'üí∞ $200,000'},
        {type: 'stars', amount: 20000, label: '‚≠ê 20,000 Stars'},
        {type: 'bertons', amount: 2000, label: 'üî• 2,000 Tons'}
      ],
      rewards: [500000, 400000, 350000, 300000, 250000, 200000, 150000, 100000]
    },
    diamond: {
      name: 'üíé Diamond Case',
      payments: [
        {type: 'coins', amount: 1000000, label: 'üí∞ $1,000,000'},
        {type: 'stars', amount: 100000, label: '‚≠ê 100,000 Stars'},
        {type: 'bertons', amount: 10000, label: 'üî• 10,000 Tons'}
      ],
      rewards: [2000000, 1750000, 1500000, 1250000, 1000000, 800000, 600000, 500000]
    },
    legendary: {
      name: 'üåü Legendary Case',
      payments: [
        {type: 'coins', amount: 5000000, label: 'üí∞ $5,000,000'},
        {type: 'stars', amount: 500000, label: '‚≠ê 500,000 Stars'},
        {type: 'bertons', amount: 50000, label: 'üî• 50,000 Tons'}
      ],
      rewards: [10000000, 8000000, 7000000, 6000000, 5000000, 4000000, 3500000, 2500000]
    }
  };
  
  const config = caseConfigs[type];
  title.innerText = config.name;
  
  options.innerHTML = '';
  config.payments.forEach(payment => {
    const btn = document.createElement('button');
    btn.className = 'popup-btn';
    btn.innerText = payment.label;
    btn.onclick = () => openCaseWithPayment(config.name, config.rewards, payment);
    options.appendChild(btn);
  });
  
  popup.classList.add('active');
}

function openCaseWithPayment(name, rewards, payment) {
  const currencies = {coins, stars, bertons};
  
  if (currencies[payment.type] < payment.amount) {
    alert(`‚ùå Not enough! Need ${payment.label}`);
    return;
  }
  
  if (payment.type === 'coins') coins -= payment.amount;
  else if (payment.type === 'stars') stars -= payment.amount;
  else if (payment.type === 'bertons') bertons -= payment.amount;
  
  save();
  updateUI();
  closeCaseSelection();
  
  openCaseAnimation(name, rewards, 'coins');
}

function closeCaseSelection() {
  document.getElementById('caseSelectionPopup').classList.remove('active');
}

// CASE OPENING ANIMATION (FIX: Reset animation state)
function openCaseAnimation(title, rewards, rewardType = 'coins') {
  const popup = document.getElementById('casePopup');
  const titleEl = document.getElementById('caseTitle');
  const reelItems = document.getElementById('caseReelItems');
  const rewardEl = document.getElementById('caseReward');
  const claimBtn = document.getElementById('caseClaimBtn');
  
  // Reset animation state
  reelItems.style.transition = 'none';
  reelItems.style.left = '0px';
  rewardEl.style.display = 'none';
  claimBtn.style.display = 'none';
  
  titleEl.innerText = title;
  popup.classList.add('active');
  
  const items = [];
  for (let i = 0; i < 50; i++) {
    items.push(rewards[Math.floor(Math.random() * rewards.length)]);
  }
  
  const winIndex = 42;
  const winAmount = rewards[Math.floor(Math.random() * rewards.length)];
  items[winIndex] = winAmount;
  
  reelItems.innerHTML = '';
  items.forEach(amount => {
    const item = document.createElement('div');
    item.className = 'case-reel-item';
    item.innerText = '$' + amount.toLocaleString();
    reelItems.appendChild(item);
  });
  
  // Restore transition and start animation
  setTimeout(() => {
    reelItems.style.transition = 'left 3s cubic-bezier(0.25,0.1,0.25,1)';
    const targetPos = -(winIndex * 100 - 125);
    reelItems.style.left = targetPos + 'px';
  }, 100);
  
  setTimeout(() => {
    rewardEl.innerText = '$' + winAmount.toLocaleString() + ' üí∞';
    rewardEl.style.display = 'block';
    claimBtn.style.display = 'inline-block';
    
    if (rewardType === 'coins') coins += winAmount;
    else if (rewardType === 'stars') stars += winAmount;
    else if (rewardType === 'bertons') bertons += winAmount;
    
    // Track cases opened for tasks
    const casesOpened = (parseInt(localStorage.getItem('casesOpened')) || 0) + 1;
    localStorage.setItem('casesOpened', casesOpened);
    updateDailyTaskProgress('case', 1);
    
    save();
    updateUI();
    updateLeaderboard();
  }, 3500);
}

function closeCase() {
  const popup = document.getElementById('casePopup');
  const reelItems = document.getElementById('caseReelItems');
  
  // Reset animation completely
  reelItems.style.transition = 'none';
  reelItems.style.left = '0px';
  
  popup.classList.remove('active');
  
  // Restore transition for next use
  setTimeout(() => {
    reelItems.style.transition = '';
  }, 50);
}

// EXCHANGE
function showExchange() {
  document.getElementById('exchangePopup').classList.add('active');
}

function closeExchange() {
  document.getElementById('exchangePopup').classList.remove('active');
}

function exchange() {
  if (coins >= 1000) {
    coins -= 1000;
    tokens += 10;
    save();
    updateUI();
    alert('‚úÖ Exchanged! +10 BER Token');
  } else {
    alert('‚ùå Not enough money (need $1,000)');
  }
}

function exchangeAllTokens() {
  if (coins < 1000) {
    alert('‚ùå Not enough money (need at least $1,000)');
    return;
  }
  
  const amount = Math.floor(coins / 1000);
  coins -= amount * 1000;
  tokens += amount * 10;
  save();
  updateUI();
  alert(`‚úÖ Exchanged $${(amount * 1000).toLocaleString()} for ${amount * 10} BER Tokens!`);
}

// DEPOSIT
function showDeposit() {
  document.getElementById('depositPopup').classList.add('active');
}

function closeDeposit() {
  document.getElementById('depositPopup').classList.remove('active');
}

function copyAddress(type) {
  const addressId = type === 'ton' ? 'tonAddress' : 'tonsAddress';
  const address = document.getElementById(addressId).innerText;
  navigator.clipboard.writeText(address).then(() => {
    alert('‚úÖ Address copied to clipboard!');
  }).catch(() => {
    alert('‚ùå Failed to copy address');
  });
}

// WITHDRAW
function showWithdraw() {
  document.getElementById('withdrawPopup').classList.add('active');
}

function closeWithdraw() {
  document.getElementById('withdrawPopup').classList.remove('active');
}

// SHOP
function loadShop() {
  const skinShop = document.getElementById('skinShop');
  const upgradeShop = document.getElementById('upgradeShop');
  
  // Load skins
  skinShop.innerHTML = '';
  Object.keys(skins).forEach(skinId => {
    const skin = skins[skinId];
    const item = document.createElement('div');
    item.className = 'shop-item';
    
    const owned = ownedSkins.includes(skinId);
    const equipped = currentSkin === skinId;
    
    let btnText = `Buy $${skin.price.toLocaleString()}`;
    let btnClass = 'shop-btn';
    let btnClick = `buySkin('${skinId}')`;
    
    if (equipped) {
      btnText = '‚úì Equipped';
      btnClass = 'shop-btn equipped';
      btnClick = '';
    } else if (owned) {
      btnText = 'Equip';
      btnClass = 'shop-btn owned';
      btnClick = `equipSkin('${skinId}')`;
    }
    
    item.innerHTML = `
      <div class="shop-info">
        <div class="shop-title">${skin.emoji} ${skin.name}</div>
        <div class="shop-price">${skin.price === 0 ? 'Free' : '$' + skin.price.toLocaleString()}</div>
      </div>
      <button class="${btnClass}" onclick="${btnClick}">${btnText}</button>
    `;
    
    skinShop.appendChild(item);
  });
  
  // Load upgrades
  upgradeShop.innerHTML = '';
  
  // Tap power upgrade
  if (tapPowerLevel < upgrades.tapPower.length) {
    const upgrade = upgrades.tapPower[tapPowerLevel];
    const item = document.createElement('div');
    item.className = 'shop-item';
    item.innerHTML = `
      <div class="shop-info">
        <div class="shop-title">‚ö° Tap Power</div>
        <div class="shop-description">Level ${upgrade.level}: +${upgrade.value} per tap</div>
        <div class="shop-price">$${upgrade.price.toLocaleString()}</div>
      </div>
      <button class="shop-btn" onclick="buyUpgrade('tapPower')">Buy</button>
    `;
    upgradeShop.appendChild(item);
  }
  
  // Passive income upgrade
  if (passiveIncomeLevel < upgrades.passiveIncome.length) {
    const upgrade = upgrades.passiveIncome[passiveIncomeLevel];
    const item = document.createElement('div');
    item.className = 'shop-item';
    item.innerHTML = `
      <div class="shop-info">
        <div class="shop-title">üí∞ Passive Income</div>
        <div class="shop-description">Level ${upgrade.level}: +${upgrade.value}/sec</div>
        <div class="shop-price">$${upgrade.price.toLocaleString()}</div>
      </div>
      <button class="shop-btn" onclick="buyUpgrade('passiveIncome')">Buy</button>
    `;
    upgradeShop.appendChild(item);
  }
  
  // Max energy upgrade
  if (maxEnergyLevel < upgrades.maxEnergy.length) {
    const upgrade = upgrades.maxEnergy[maxEnergyLevel];
    const item = document.createElement('div');
    item.className = 'shop-item';
    item.innerHTML = `
      <div class="shop-info">
        <div class="shop-title">üîã Max Energy</div>
        <div class="shop-description">Level ${upgrade.level}: ${upgrade.value} energy</div>
        <div class="shop-price">$${upgrade.price.toLocaleString()}</div>
      </div>
      <button class="shop-btn" onclick="buyUpgrade('maxEnergy')">Buy</button>
    `;
    upgradeShop.appendChild(item);
  }
}

function buySkin(skinId) {
  const skin = skins[skinId];
  if (coins >= skin.price) {
    coins -= skin.price;
    ownedSkins.push(skinId);
    currentSkin = skinId;
    save();
    updateUI();
    loadShop();
    alert(`‚úÖ Purchased ${skin.name}!`);
  } else {
    alert(`‚ùå Not enough money! Need $${skin.price.toLocaleString()}`);
  }
}

function equipSkin(skinId) {
  currentSkin = skinId;
  save();
  updateUI();
  loadShop();
  alert(`‚úÖ Equipped ${skins[skinId].name}!`);
}

function buyUpgrade(type) {
  let level, upgrade;
  
  if (type === 'tapPower') {
    level = tapPowerLevel;
    upgrade = upgrades.tapPower[level];
  } else if (type === 'passiveIncome') {
    level = passiveIncomeLevel;
    upgrade = upgrades.passiveIncome[level];
  } else if (type === 'maxEnergy') {
    level = maxEnergyLevel;
    upgrade = upgrades.maxEnergy[level];
  }
  
  if (coins >= upgrade.price) {
    coins -= upgrade.price;
    
    if (type === 'tapPower') {
      tapPower = upgrade.value;
      tapPowerLevel++;
    } else if (type === 'passiveIncome') {
      passiveIncome = upgrade.value;
      passiveIncomeLevel++;
    } else if (type === 'maxEnergy') {
      maxEnergy = upgrade.value;
      energy = maxEnergy;
      maxEnergyLevel++;
    }
    
    save();
    updateUI();
    loadShop();
    alert(`‚úÖ Upgrade purchased!`);
  } else {
    alert(`‚ùå Not enough money! Need $${upgrade.price.toLocaleString()}`);
  }
}

// TASKS with categories
const tasks = {
  social: [
    {id: 101, title: 'üì± Join Telegram Channel', reward: 10000, link: 'https://t.me/beroncrypto', icon: 'üì±'},
    {id: 102, title: 'üì∫ Subscribe YouTube', reward: 7500, link: 'https://youtube.com/@beroncrypto', icon: 'üì∫'},
    {id: 103, title: 'üê¶ Follow on Twitter/X', reward: 5000, link: 'https://twitter.com/beroncrypto', icon: 'üê¶'},
    {id: 104, title: 'üí¨ Join Discord Server', reward: 8000, link: 'https://discord.gg/beroncrypto', icon: 'üí¨'},
    {id: 105, title: 'üì∏ Follow on Instagram', reward: 6000, link: 'https://instagram.com/beroncrypto', icon: 'üì∏'},
    {id: 106, title: 'üéÆ Join TikTok', reward: 5000, link: 'https://tiktok.com/@beroncrypto', icon: 'üéÆ'}
  ],
  achievement: [
    {id: 201, title: 'üí∞ Earn 100,000 Coins', reward: 25000, check: () => coins >= 100000, icon: 'üí∞'},
    {id: 202, title: '‚ö° Reach Level 10', reward: 30000, check: () => level >= 10, icon: '‚ö°'},
    {id: 203, title: 'üé∞ Open 10 Cases', reward: 20000, check: () => (parseInt(localStorage.getItem('casesOpened')) || 0) >= 10, icon: 'üé∞'},
    {id: 204, title: 'üëÜ Tap 1,000 Times', reward: 15000, check: () => (parseInt(localStorage.getItem('totalTaps')) || 0) >= 1000, icon: 'üëÜ'},
    {id: 205, title: 'üíé Earn 1,000 Tokens', reward: 50000, check: () => tokens >= 1000, icon: 'üíé'},
    {id: 206, title: 'üèÜ Reach Level 25', reward: 100000, check: () => level >= 25, icon: 'üèÜ'},
    {id: 207, title: '‚≠ê Collect 10,000 Stars', reward: 75000, check: () => stars >= 10000, icon: '‚≠ê'}
  ],
  special: [
    {id: 301, title: 'üéØ Complete All Social Tasks', reward: 50000, check: () => {
      return tasks.social.every(t => completedTasks.includes(t.id));
    }, icon: 'üéØ'},
    {id: 302, title: 'üî• Play All Mini Games', reward: 40000, check: () => {
      const played = JSON.parse(localStorage.getItem('gamesPlayed') || '[]');
      return played.length >= 4;
    }, icon: 'üî•'},
    {id: 303, title: 'üí™ Complete 10 Daily Tasks', reward: 100000, check: () => {
      return (parseInt(localStorage.getItem('dailyTasksCompleted')) || 0) >= 10;
    }, icon: 'üí™'},
    {id: 304, title: 'üåü Invite 5 Friends', reward: 250000, check: () => {
      return (parseInt(localStorage.getItem('friendsInvited')) || 0) >= 5;
    }, icon: 'üåü'}
  ]
};

let dailyTasks = [];
let totalTaskEarnings = parseInt(localStorage.getItem('totalTaskEarnings')) || 0;
let lastDailyTaskReset = parseInt(localStorage.getItem('lastDailyTaskReset')) || 0;
let dailyTasksCompleted = parseInt(localStorage.getItem('dailyTasksCompleted')) || 0;

function generateDailyTasks() {
  const now = Date.now();
  const dayStart = new Date().setHours(0, 0, 0, 0);
  
  if (now - lastDailyTaskReset < 86400000 && lastDailyTaskReset >= dayStart) {
    dailyTasks = JSON.parse(localStorage.getItem('dailyTasks') || '[]');
    return;
  }
  
  // Reset daily tasks
  lastDailyTaskReset = now;
  localStorage.setItem('lastDailyTaskReset', lastDailyTaskReset);
  
  const dailyTaskTemplates = [
    {id: 'daily_tap', title: 'üëÜ Tap 100 Times', reward: 5000, target: 100, current: 0, type: 'tap', icon: 'üëÜ'},
    {id: 'daily_earn', title: 'üí∞ Earn 10,000 Coins', reward: 8000, target: 10000, current: 0, type: 'earn', icon: 'üí∞'},
    {id: 'daily_case', title: 'üé∞ Open 3 Cases', reward: 12000, target: 3, current: 0, type: 'case', icon: 'üé∞'},
    {id: 'daily_game', title: 'üéÆ Play 2 Mini Games', reward: 10000, target: 2, current: 0, type: 'game', icon: 'üéÆ'},
    {id: 'daily_level', title: '‚ö° Gain 1 Level', reward: 15000, target: 1, current: 0, type: 'level', icon: '‚ö°'}
  ];
  
  // Select 3 random daily tasks
  dailyTasks = [];
  const shuffled = dailyTaskTemplates.sort(() => Math.random() - 0.5);
  for (let i = 0; i < 3; i++) {
    dailyTasks.push({...shuffled[i]});
  }
  
  localStorage.setItem('dailyTasks', JSON.stringify(dailyTasks));
}

function updateDailyTaskProgress(type, amount = 1) {
  let updated = false;
  dailyTasks = dailyTasks.map(task => {
    if (task.type === type && task.current >= 0 && task.current < task.target) {
      task.current = Math.min(task.current + amount, task.target);
      updated = true;
    }
    return task;
  });
  
  if (updated) {
    localStorage.setItem('dailyTasks', JSON.stringify(dailyTasks));
  }
}

function updateDailyTaskTimer() {
  const now = Date.now();
  const tomorrow = new Date();
  tomorrow.setHours(24, 0, 0, 0);
  const timeLeft = tomorrow - now;
  
  const hours = Math.floor(timeLeft / 3600000);
  const mins = Math.floor((timeLeft % 3600000) / 60000);
  const secs = Math.floor((timeLeft % 60000) / 1000);
  
  const timerEl = document.getElementById('dailyTaskReset');
  if (timerEl) {
    timerEl.innerText = `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
  }
}

function loadTasks() {
  generateDailyTasks();
  updateDailyTaskTimer();
  
  document.getElementById('totalTaskEarnings').innerText = '$' + totalTaskEarnings.toLocaleString();
  
  // Load daily tasks
  const dailyList = document.getElementById('dailyTaskList');
  if (dailyList) {
    dailyList.innerHTML = '';
    
    dailyTasks.forEach(task => {
      const item = document.createElement('div');
      item.className = 'task-item';
      
      const isCompleted = task.current < 0;
      const isClaimable = task.current >= task.target && task.current >= 0;
      const progress = task.current >= 0 ? Math.floor((task.current / task.target) * 100) : 100;
      
      item.innerHTML = `
        <div class="task-info">
          <div class="task-title">${task.icon} ${task.title}</div>
          <div style="display:flex;gap:10px;align-items:center;margin-top:8px">
            <div style="flex:1;height:8px;background:rgba(0,0,0,0.6);border-radius:10px;overflow:hidden">
              <div style="width:${progress}%;height:100%;background:linear-gradient(90deg,#4ade80,#00ff64);transition:width 0.3s"></div>
            </div>
            <div style="font-size:12px;color:#ccc;min-width:60px">${isCompleted ? 'Done' : task.current + '/' + task.target}</div>
          </div>
          <div class="task-reward" style="margin-top:5px">Reward: $${task.reward.toLocaleString()}</div>
        </div>
        <button class="task-btn ${isCompleted ? 'completed' : ''}" onclick="claimDailyTask('${task.id}')" ${!isClaimable || isCompleted ? 'disabled style="opacity:0.5;cursor:not-allowed"' : ''}>
          ${isCompleted ? '‚úì Done' : (isClaimable ? 'Claim' : 'Locked')}
        </button>
      `;
      
      dailyList.appendChild(item);
    });
  }
  
  // Load social tasks
  const socialList = document.getElementById('socialTaskList');
  if (socialList) {
    socialList.innerHTML = '';
    
    tasks.social.forEach(task => {
      const item = document.createElement('div');
      item.className = 'task-item';
      
      const isCompleted = completedTasks.includes(task.id);
      
      item.innerHTML = `
        <div class="task-info">
          <div class="task-title">${task.icon} ${task.title}</div>
          <div class="task-reward">Reward: $${task.reward.toLocaleString()}</div>
        </div>
        <button class="task-btn ${isCompleted ? 'completed' : ''}" onclick="completeTask(${task.id}, '${task.link}')">
          ${isCompleted ? '‚úì Done' : 'Start'}
        </button>
      `;
      
      socialList.appendChild(item);
    });
  }
  
  // Load achievement tasks
  const achievementList = document.getElementById('achievementTaskList');
  if (achievementList) {
    achievementList.innerHTML = '';
    
    tasks.achievement.forEach(task => {
      const item = document.createElement('div');
      item.className = 'task-item';
      
      const isCompleted = completedTasks.includes(task.id);
      const canClaim = !isCompleted && task.check();
      
      item.innerHTML = `
        <div class="task-info">
          <div class="task-title">${task.icon} ${task.title}</div>
          <div class="task-reward">Reward: $${task.reward.toLocaleString()}</div>
        </div>
        <button class="task-btn ${isCompleted ? 'completed' : (canClaim ? 'ready' : '')}" onclick="claimAchievement(${task.id})" ${!canClaim && !isCompleted ? 'disabled style="opacity:0.5;cursor:not-allowed"' : ''}>
          ${isCompleted ? '‚úì Done' : (canClaim ? 'Claim!' : 'Locked')}
        </button>
      `;
      
      achievementList.appendChild(item);
    });
  }
  
  // Load special tasks
  const specialList = document.getElementById('specialTaskList');
  if (specialList) {
    specialList.innerHTML = '';
    
    tasks.special.forEach(task => {
      const item = document.createElement('div');
      item.className = 'task-item';
      
      const isCompleted = completedTasks.includes(task.id);
      const canClaim = !isCompleted && task.check();
      
      item.innerHTML = `
        <div class="task-info">
          <div class="task-title">${task.icon} ${task.title}</div>
          <div class="task-reward">Reward: $${task.reward.toLocaleString()}</div>
        </div>
        <button class="task-btn ${isCompleted ? 'completed' : (canClaim ? 'ready' : '')}" onclick="claimAchievement(${task.id})" ${!canClaim && !isCompleted ? 'disabled style="opacity:0.5;cursor:not-allowed"' : ''}>
          ${isCompleted ? '‚úì Done' : (canClaim ? 'Claim!' : 'Locked')}
        </button>
      `;
      
      specialList.appendChild(item);
    });
  }
}

function claimDailyTask(taskId) {
  const task = dailyTasks.find(t => t.id === taskId);
  if (!task || task.current < task.target) return;
  
  coins += task.reward;
  totalTaskEarnings += task.reward;
  task.current = -1; // Mark as claimed
  
  localStorage.setItem('totalTaskEarnings', totalTaskEarnings);
  localStorage.setItem('dailyTasks', JSON.stringify(dailyTasks));
  
  dailyTasksCompleted++;
  localStorage.setItem('dailyTasksCompleted', dailyTasksCompleted);
  
  save();
  updateUI();
  loadTasks();
  updateLeaderboard();
  alert(`‚úÖ Daily task completed! +$${task.reward.toLocaleString()}`);
}

function completeTask(taskId, link) {
  if (completedTasks.includes(taskId)) return;
  
  window.open(link, '_blank');
  
  setTimeout(() => {
    const allTasks = [...tasks.social, ...tasks.achievement, ...tasks.special];
    const task = allTasks.find(t => t.id === taskId);
    
    coins += task.reward;
    totalTaskEarnings += task.reward;
    completedTasks.push(taskId);
    
    localStorage.setItem('totalTaskEarnings', totalTaskEarnings);
    
    save();
    updateUI();
    loadTasks();
    updateLeaderboard();
    alert(`‚úÖ Task completed! +$${task.reward.toLocaleString()}`);
  }, 3000);
}

function claimAchievement(taskId) {
  if (completedTasks.includes(taskId)) return;
  
  const allTasks = [...tasks.achievement, ...tasks.special];
  const task = allTasks.find(t => t.id === taskId);
  
  if (!task || !task.check()) {
    alert('‚ùå Requirements not met yet!');
    return;
  }
  
  coins += task.reward;
  totalTaskEarnings += task.reward;
  completedTasks.push(taskId);
  
  localStorage.setItem('totalTaskEarnings', totalTaskEarnings);
  
  save();
  updateUI();
  loadTasks();
  updateLeaderboard();
  alert(`‚úÖ Achievement unlocked! +$${task.reward.toLocaleString()}`);
}

// Update daily task timer every second
setInterval(() => {
  updateDailyTaskTimer();
}, 1000);

// LEADERBOARD
let currentLeaderboardFilter = 'all';

async function updateLeaderboard() {
  try {
    await window.storage.set('player_' + playerName, JSON.stringify({
      name: playerName,
      score: coins
    }), true);
  } catch (error) {
    console.error('Failed to update leaderboard:', error);
  }
}

function filterLeaderboard(filter) {
  currentLeaderboardFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.dataset.filter === filter || btn.getAttribute('onclick').includes(filter)) {
      btn.classList.add('active');
    }
  });
  loadLeaderboard();
}

async function loadLeaderboard() {
  const list = document.getElementById('leaderboardList');
  list.innerHTML = '<div style="text-align:center;color:#ccc">Loading...</div>';
  
  try {
    const result = await window.storage.list('player_', true);
    
    if (!result || !result.keys || result.keys.length === 0) {
      list.innerHTML = '<div style="text-align:center;color:#ccc">No players yet</div>';
      const userRankEl = document.getElementById('userRank');
      const userScoreEl = document.getElementById('userScore');
      if (userRankEl) userRankEl.innerText = '#1';
      if (userScoreEl) userScoreEl.innerText = '$' + coins.toLocaleString();
      return;
    }
    
    const players = [];
    for (const key of result.keys) {
      try {
        const data = await window.storage.get(key, true);
        if (data && data.value) {
          const player = JSON.parse(data.value);
          players.push(player);
        }
      } catch (e) {
        console.error('Error loading player:', e);
      }
    }
    
    players.sort((a, b) => b.score - a.score);
    
    // Update user info
    const userIndex = players.findIndex(p => p.name === playerName);
    const userRankEl = document.getElementById('userRank');
    const userScoreEl = document.getElementById('userScore');
    if (userRankEl) userRankEl.innerText = userIndex >= 0 ? '#' + (userIndex + 1) : '#999';
    if (userScoreEl) userScoreEl.innerText = '$' + coins.toLocaleString();
    
    list.innerHTML = '';
    players.slice(0, 100).forEach((player, i) => {
      const item = document.createElement('div');
      item.className = 'leaderboard-item' + (player.name === playerName ? ' current' : '');
      
      const medals = ['ü•á', 'ü•à', 'ü•â'];
      const rankDisplay = i < 3 ? medals[i] : `#${i + 1}`;
      
      // Calculate rank badge
      let rankBadge = 'ü•â';
      if (player.score > 5000000) rankBadge = 'üíé';
      else if (player.score > 1000000) rankBadge = 'üèÜ';
      else if (player.score > 500000) rankBadge = 'ü•á';
      else if (player.score > 100000) rankBadge = 'ü•à';
      
      item.innerHTML = `
        <div class="leaderboard-rank">${rankDisplay}</div>
        <div class="leaderboard-info">
          <div class="leaderboard-name">${rankBadge} ${player.name}</div>
          <div class="leaderboard-score">$${player.score.toLocaleString()}</div>
        </div>
      `;
      
      list.appendChild(item);
    });
  } catch (error) {
    console.error('Failed to load leaderboard:', error);
    list.innerHTML = '<div style="text-align:center;color:#ccc">Failed to load leaderboard</div>';
  }
}

updateLeaderboard();

// MINES GAME
let minesGame = null;

function updateMineCount() {
  const count = document.getElementById('minesCount').value;
  document.getElementById('mineCountDisplay').innerText = count;
}

function showMinesGame() {
  document.getElementById('minesPopup').classList.add('active');
  document.getElementById('minesGameArea').style.display = 'none';
  document.getElementById('minesStartBtn').style.display = 'inline-block';
  document.getElementById('minesCloseBtn').style.display = 'inline-block';
  updateMineCount();
}

function setMinesBet(amount) {
  document.getElementById('minesBet').value = amount;
}

function trackGamePlayed(gameName) {
  const gamesPlayed = JSON.parse(localStorage.getItem('gamesPlayed') || '[]');
  if (!gamesPlayed.includes(gameName)) {
    gamesPlayed.push(gameName);
    localStorage.setItem('gamesPlayed', JSON.stringify(gamesPlayed));
  }
  updateDailyTaskProgress('game', 1);
}

function startMinesGame() {
  const bet = parseInt(document.getElementById('minesBet').value) || 0;
  const mineCount = parseInt(document.getElementById('minesCount').value) || 7;
  
  if (bet <= 0) {
    alert('‚ùå Enter a valid bet amount!');
    return;
  }
  if (coins < bet) {
    alert('‚ùå Not enough money!');
    return;
  }
  
  trackGamePlayed('mines');
  
  coins -= bet;
  save();
  updateUI();
  
  document.getElementById('minesGameArea').style.display = 'block';
  document.getElementById('minesStartBtn').style.display = 'none';
  document.getElementById('minesCloseBtn').style.display = 'none';
  
  const grid = document.getElementById('minesGrid');
  grid.innerHTML = '';
  
  const positions = Array.from({length: 25}, (_, i) => i);
  const bombPositions = [];
  for (let i = 0; i < mineCount; i++) {
    const idx = Math.floor(Math.random() * positions.length);
    bombPositions.push(positions.splice(idx, 1)[0]);
  }
  
  minesGame = {
    bet,
    revealed: 0,
    bombPositions,
    currentWin: bet,
    active: true,
    totalMines: mineCount
  };
  
  document.getElementById('minesCurrentWin').innerText = bet;
  
  for (let i = 0; i < 25; i++) {
    const cell = document.createElement('div');
    cell.className = 'mine-cell';
    cell.dataset.index = i;
    cell.onclick = () => revealMineCell(i);
    grid.appendChild(cell);
  }
}

function revealMineCell(index) {
  if (!minesGame || !minesGame.active) return;
  
  const cells = document.querySelectorAll('.mine-cell');
  const cell = cells[index];
  
  if (cell.classList.contains('revealed')) return;
  
  cell.classList.add('revealed');
  
  if (minesGame.bombPositions.includes(index)) {
    cell.classList.add('bomb');
    cell.innerText = 'üí£';
    minesGame.active = false;
    
    setTimeout(() => {
      alert('üí• BOOM! You lost $' + minesGame.bet);
      closeMinesGame();
    }, 500);
  } else {
    cell.classList.add('gem');
    cell.innerText = 'üíé';
    minesGame.revealed++;
    
    const baseMultiplier = 0.10 + (minesGame.totalMines * 0.01);
    minesGame.currentWin = Math.floor(minesGame.bet * (1 + minesGame.revealed * baseMultiplier));
    document.getElementById('minesCurrentWin').innerText = minesGame.currentWin;
  }
}

function cashoutMines() {
  if (!minesGame || !minesGame.active) return;
  
  coins += minesGame.currentWin;
  save();
  updateUI();
  updateLeaderboard();
  
  alert('‚úÖ Cashed out $' + minesGame.currentWin + '!');
  closeMinesGame();
}

function closeMinesGame() {
  minesGame = null;
  document.getElementById('minesPopup').classList.remove('active');
}

// COIN FLIP
let coinFlipGame = null;

function showCoinFlip() {
  document.getElementById('coinFlipPopup').classList.add('active');
  document.getElementById('coinContainer').style.display = 'none';
  document.getElementById('coinResult').style.display = 'none';
  document.getElementById('coinFlipBtn').style.display = 'none';
  coinFlipGame = {choice: null, bet: 0};
}

function setCoinBet(amount) {
  document.getElementById('coinBet').value = amount;
}

function selectCoinSide(side) {
  coinFlipGame.choice = side;
  document.querySelectorAll('.choice-btn').forEach(btn => btn.classList.remove('selected'));
  document.querySelector('.choice-btn.' + side).classList.add('selected');
  document.getElementById('coinFlipBtn').style.display = 'inline-block';
}

function flipCoin() {
  const bet = parseInt(document.getElementById('coinBet').value) || 0;
  if (bet <= 0) {
    alert('‚ùå Enter a valid bet amount!');
    return;
  }
  if (!coinFlipGame.choice) {
    alert('‚ùå Select heads or tails!');
    return;
  }
  if (coins < bet) {
    alert('‚ùå Not enough money!');
    return;
  }
  
  trackGamePlayed('coinflip');
  
  coins -= bet;
  save();
  updateUI();
  
  coinFlipGame.bet = bet;
  
  document.getElementById('coinChoices').style.display = 'none';
  document.getElementById('coinFlipBtn').style.display = 'none';
  document.getElementById('coinContainer').style.display = 'block';
  
  const coin = document.getElementById('coin');
  coin.classList.remove('flipping');
  void coin.offsetWidth;
  coin.classList.add('flipping');
  
  const playerWins = Math.random() < 0.3;
  const result = playerWins ? coinFlipGame.choice : (coinFlipGame.choice === 'heads' ? 'tails' : 'heads');
  
  setTimeout(() => {
    coin.style.transform = result === 'heads' ? 'rotateY(0deg)' : 'rotateY(180deg)';
    
    setTimeout(() => {
      const resultDiv = document.getElementById('coinResult');
      if (playerWins) {
        const winAmount = Math.floor(bet * 1.95);
        coins += winAmount;
        save();
        updateUI();
        updateLeaderboard();
        resultDiv.innerText = `üéâ YOU WIN $${winAmount}!`;
        resultDiv.style.color = '#4ade80';
      } else {
        resultDiv.innerText = `üò¢ YOU LOST $${bet}`;
        resultDiv.style.color = '#fff';
      }
      resultDiv.style.display = 'block';
    }, 500);
  }, 2000);
}

function closeCoinFlip() {
  document.getElementById('coinFlipPopup').classList.remove('active');
  document.getElementById('coinChoices').style.display = 'flex';
  coinFlipGame = null;
}

// DROP GAME
let dropGame = null;

function startDropGame() {
  document.getElementById('dropGamePopup').classList.add('active');
  document.getElementById('dropBetArea').style.display = 'block';
  document.getElementById('dropGameArea').style.display = 'none';
  document.getElementById('dropCloseBtn').style.display = 'inline-block';
}

function setDropBet(amount) {
  document.getElementById('dropBet').value = amount;
}

function startDropGameWithBet() {
  const bet = parseInt(document.getElementById('dropBet').value) || 0;
  if (bet <= 0) {
    alert('‚ùå Enter a valid bet amount!');
    return;
  }
  if (coins < bet) {
    alert('‚ùå Not enough money!');
    return;
  }
  
  trackGamePlayed('drop');
  
  coins -= bet;
  save();
  updateUI();
  
  document.getElementById('dropBetArea').style.display = 'none';
  document.getElementById('dropGameArea').style.display = 'block';
  document.getElementById('dropCloseBtn').style.display = 'none';
  document.getElementById('dropGameOver').style.display = 'none';
  
  const canvas = document.getElementById('dropGameCanvas');
  const ctx = canvas.getContext('2d');
  
  dropGame = {
    bet,
    score: 0,
    drops: [],
    gameOver: false,
    frame: 0,
    timeLeft: 30,
    startTime: Date.now()
  };
  
  document.getElementById('dropScore').innerText = '$0';
  document.getElementById('dropTimer').innerText = '00:30';
  
  function gameLoop() {
    if (dropGame.gameOver) return;
    
    const elapsed = Math.floor((Date.now() - dropGame.startTime) / 1000);
    dropGame.timeLeft = Math.max(0, 30 - elapsed);
    
    const mins = Math.floor(dropGame.timeLeft / 60);
    const secs = dropGame.timeLeft % 60;
    document.getElementById('dropTimer').innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    
    if (dropGame.timeLeft <= 0) {
      endDropGame();
      return;
    }
    
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    dropGame.frame++;
    if (dropGame.frame % 20 === 0) {
      dropGame.drops.push({
        x: Math.random() * (canvas.width - 50),
        y: -50,
        type: Math.random() > 0.3 ? 'star' : 'bomb',
        speed: 2 + Math.random() * 2.5,
        size: 40,
        clicked: false
      });
    }
    
    dropGame.drops = dropGame.drops.filter(drop => {
      if (drop.clicked) return false;
      
      drop.y += drop.speed;
      
      if (drop.type === 'star') {
        ctx.shadowBlur = 15;
        ctx.shadowColor = '#ffffff';
        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 35px Arial';
        ctx.fillText('‚ú±', drop.x + 5, drop.y + 32);
        ctx.shadowBlur = 0;
      } else {
        ctx.shadowBlur = 10;
        ctx.shadowColor = '#ff0000';
        ctx.fillStyle = '#ff0000';
        ctx.font = 'bold 30px Arial';
        ctx.fillText('üí£', drop.x + 5, drop.y + 30);
        ctx.shadowBlur = 0;
      }
      
      return drop.y < canvas.height;
    });
    
    document.getElementById('dropScore').innerText = '$' + dropGame.score;
    
    requestAnimationFrame(gameLoop);
  }
  
  gameLoop();
  
  function handleClick(e) {
    if (dropGame.gameOver) return;
    
    const rect = canvas.getBoundingClientRect();
    const clickX = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
    const clickY = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
    
    for (let i = dropGame.drops.length - 1; i >= 0; i--) {
      const drop = dropGame.drops[i];
      if (drop.clicked) continue;
      
      const centerX = drop.x + 20;
      const centerY = drop.y + 20;
      
      const dx = clickX - centerX;
      const dy = clickY - centerY;
      const distance = Math.sqrt(dx * dx + dy * dy);
      
      if (distance < 30) {
        drop.clicked = true;
        
        if (drop.type === 'star') {
          dropGame.score += 10;
        } else {
          dropGame.score = Math.max(0, dropGame.score - 30);
        }
        
        break;
      }
    }
  }
  
  canvas.addEventListener('click', handleClick);
  canvas.addEventListener('touchstart', (e) => {
    e.preventDefault();
    handleClick(e);
  }, {passive: false});
}

function endDropGame() {
  dropGame.gameOver = true;
  const finalScore = dropGame.score;
  const result = dropGame.bet + finalScore;
  coins += result;
  save();
  updateUI();
  updateLeaderboard();
  document.getElementById('dropEarned').innerText = result;
  document.getElementById('dropGameOver').style.display = 'flex';
}

function restartDropGame() {
  startDropGame();
}

function closeDropGame() {
  dropGame = null;
  document.getElementById('dropGamePopup').classList.remove('active');
}

// SNAKE GAME
let snakeGame = null;

function startSnakeGame() {
  document.getElementById('snakeGamePopup').classList.add('active');
  document.getElementById('snakeBetArea').style.display = 'block';
  document.getElementById('snakeGameArea').style.display = 'none';
  document.getElementById('snakeCloseBtn').style.display = 'inline-block';
}

function setSnakeBet(amount) {
  document.getElementById('snakeBet').value = amount;
}

function startSnakeGameWithBet() {
  const bet = parseInt(document.getElementById('snakeBet').value) || 0;
  if (bet <= 0) {
    alert('‚ùå Enter a valid bet amount!');
    return;
  }
  if (coins < bet) {
    alert('‚ùå Not enough money!');
    return;
  }
  
  trackGamePlayed('snake');
  
  coins -= bet;
  save();
  updateUI();
  
  document.getElementById('snakeBetArea').style.display = 'none';
  document.getElementById('snakeGameArea').style.display = 'block';
  document.getElementById('snakeCloseBtn').style.display = 'none';
  document.getElementById('snakeGameOver').style.display = 'none';
  
  const canvas = document.getElementById('snakeGameCanvas');
  const ctx = canvas.getContext('2d');
  const gridSize = 20;
  
  snakeGame = {
    bet,
    snake: [{x: 10, y: 10}],
    direction: {x: 1, y: 0},
    nextDirection: {x: 1, y: 0},
    food: {x: 15, y: 15},
    score: 0,
    gameOver: false,
    speed: 100,
    lastUpdate: Date.now()
  };
  
  document.getElementById('snakeScore').innerText = 'Score: 0';
  
  function placeFood() {
    snakeGame.food = {
      x: Math.floor(Math.random() * (canvas.width / gridSize)),
      y: Math.floor(Math.random() * (canvas.height / gridSize))
    };
  }
  
  function gameLoop() {
    if (snakeGame.gameOver) return;
    
    const now = Date.now();
    snakeGame.lastUpdate = now;
    snakeGame.direction = snakeGame.nextDirection;
    
    const head = {
      x: snakeGame.snake[0].x + snakeGame.direction.x,
      y: snakeGame.snake[0].y + snakeGame.direction.y
    };
    
    if (head.x < 0 || head.x >= canvas.width / gridSize ||
        head.y < 0 || head.y >= canvas.height / gridSize ||
        snakeGame.snake.some(seg => seg.x === head.x && seg.y === head.y)) {
      endSnakeGame();
      return;
    }
    
    snakeGame.snake.unshift(head);
    
    if (head.x === snakeGame.food.x && head.y === snakeGame.food.y) {
      snakeGame.score += 10;
      document.getElementById('snakeScore').innerText = 'Score: ' + snakeGame.score;
      placeFood();
    } else {
      snakeGame.snake.pop();
    }
    
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    ctx.strokeStyle = '#111';
    for (let i = 0; i < canvas.width; i += gridSize) {
      ctx.beginPath();
      ctx.moveTo(i, 0);
      ctx.lineTo(i, canvas.height);
      ctx.stroke();
    }
    for (let i = 0; i < canvas.height; i += gridSize) {
      ctx.beginPath();
      ctx.moveTo(0, i);
      ctx.lineTo(canvas.width, i);
      ctx.stroke();
    }
    
    ctx.fillStyle = '#aaa';
    snakeGame.snake.forEach((seg, i) => {
      ctx.fillRect(seg.x * gridSize + 1, seg.y * gridSize + 1, gridSize - 2, gridSize - 2);
      if (i === 0) {
        ctx.fillStyle = '#ccc';
        ctx.fillRect(seg.x * gridSize + 1, seg.y * gridSize + 1, gridSize - 2, gridSize - 2);
        ctx.fillStyle = '#aaa';
      }
    });
    
    ctx.fillStyle = '#ffd700';
    ctx.fillRect(snakeGame.food.x * gridSize + 1, snakeGame.food.y * gridSize + 1, gridSize - 2, gridSize - 2);
    
    setTimeout(() => requestAnimationFrame(gameLoop), snakeGame.speed);
  }
  
  gameLoop();
  
  let touchStartX = 0;
  let touchStartY = 0;
  
  canvas.addEventListener('touchstart', (e) => {
    touchStartX = e.touches[0].clientX;
    touchStartY = e.touches[0].clientY;
  });
  
  canvas.addEventListener('touchend', (e) => {
    const touchEndX = e.changedTouches[0].clientX;
    const touchEndY = e.changedTouches[0].clientY;
    const dx = touchEndX - touchStartX;
    const dy = touchEndY - touchStartY;
    
    if (Math.abs(dx) > Math.abs(dy)) {
      if (dx > 0 && snakeGame.direction.x === 0) snakeGame.nextDirection = {x: 1, y: 0};
      if (dx < 0 && snakeGame.direction.x === 0) snakeGame.nextDirection = {x: -1, y: 0};
    } else {
      if (dy > 0 && snakeGame.direction.y === 0) snakeGame.nextDirection = {x: 0, y: 1};
      if (dy < 0 && snakeGame.direction.y === 0) snakeGame.nextDirection = {x: 0, y: -1};
    }
  });
  
  document.addEventListener('keydown', (e) => {
    if (!snakeGame || snakeGame.gameOver) return;
    if (e.key === 'ArrowUp' && snakeGame.direction.y === 0) snakeGame.nextDirection = {x: 0, y: -1};
    if (e.key === 'ArrowDown' && snakeGame.direction.y === 0) snakeGame.nextDirection = {x: 0, y: 1};
    if (e.key === 'ArrowLeft' && snakeGame.direction.x === 0) snakeGame.nextDirection = {x: -1, y: 0};
    if (e.key === 'ArrowRight' && snakeGame.direction.x === 0) snakeGame.nextDirection = {x: 1, y: 0};
  });
}

function endSnakeGame() {
  snakeGame.gameOver = true;
  const multiplier = Math.floor(snakeGame.score / 10) * 0.1;
  const result = Math.floor(snakeGame.bet * (1 + multiplier));
  coins += result;
  save();
  updateUI();
  updateLeaderboard();
  document.getElementById('snakeEarned').innerText = result;
  document.getElementById('snakeGameOver').style.display = 'flex';
}

function restartSnakeGame() {
  startSnakeGame();
}

function closeSnakeGame() {
  snakeGame = null;
  document.getElementById('snakeGamePopup').classList.remove('active');
}
</script>
</body>
</html>
