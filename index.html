<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VELVET CROWN ‚Äî Casino</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cinzel:wght@400;600;900&family=EB+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
<style>
:root{
  --gold:#d4a843;--gold2:#f7d98b;--gold3:#8b6914;
  --red:#9b1c1c;--red2:#c0392b;
  --felt:#071a10;--felt2:#0c2918;
  --dark:#03070a;--cream:#f5e6c8;
  --glow:rgba(212,168,67,0.6);
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}

body{
  background:var(--dark);
  color:var(--cream);
  font-family:'EB Garamond',serif;
  overflow-x:hidden;
  min-height:100vh;
}

/* ‚îÄ‚îÄ CANVAS BACKGROUND ‚îÄ‚îÄ */
#bgCanvas{
  position:fixed;inset:0;
  pointer-events:none;z-index:0;
  opacity:0.7;
}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
header{
  position:relative;z-index:2;
  text-align:center;
  padding:60px 20px 36px;
  border-bottom:1px solid rgba(212,168,67,0.25);
}
header::after{
  content:'';position:absolute;bottom:-1px;left:50%;transform:translateX(-50%);
  width:60%;height:1px;
  background:linear-gradient(90deg,transparent,var(--gold),transparent);
}

.logo-wrap{
  display:inline-block;
  position:relative;
}

.crown-anim{
  font-size:56px;
  display:block;
  animation:crownFloat 4s ease-in-out infinite;
  filter:drop-shadow(0 0 20px var(--gold));
}
@keyframes crownFloat{
  0%,100%{transform:translateY(0) rotate(-5deg);filter:drop-shadow(0 0 20px var(--gold));}
  50%{transform:translateY(-10px) rotate(5deg);filter:drop-shadow(0 0 40px var(--gold2));}
}

.casino-name{
  font-family:'Cinzel Decorative',cursive;
  font-weight:900;
  font-size:clamp(36px,7vw,88px);
  line-height:1;
  background:linear-gradient(135deg,var(--gold3) 0%,var(--gold) 30%,var(--gold2) 50%,var(--gold) 70%,var(--gold3) 100%);
  background-size:200% auto;
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  animation:shimmer 3s linear infinite;
  letter-spacing:0.08em;
}
@keyframes shimmer{
  0%{background-position:200% center;}
  100%{background-position:-200% center;}
}

.neon-sub{
  font-family:'Cinzel',serif;
  font-size:13px;letter-spacing:0.5em;
  text-transform:uppercase;
  margin-top:10px;
  color:rgba(212,168,67,0.5);
  animation:flicker 8s linear infinite;
}
@keyframes flicker{
  0%,19%,21%,23%,25%,54%,56%,100%{color:rgba(212,168,67,0.5);text-shadow:none;}
  20%,55%{color:rgba(212,168,67,0.05);text-shadow:none;}
  22%,24%{color:rgba(212,168,67,0.9);text-shadow:0 0 10px rgba(212,168,67,0.8);}
}

/* ‚îÄ‚îÄ BALANCE BAR ‚îÄ‚îÄ */
.balance-bar{
  display:flex;justify-content:center;align-items:center;gap:48px;
  padding:18px 20px;
  background:linear-gradient(90deg,transparent,rgba(212,168,67,0.06),transparent);
  border-bottom:1px solid rgba(212,168,67,0.1);
  flex-wrap:wrap;
  position:relative;z-index:2;
}
.bal-item{display:flex;flex-direction:column;align-items:center;}
.bal-label{font-family:'Cinzel';font-size:9px;letter-spacing:0.35em;color:rgba(212,168,67,0.4);text-transform:uppercase;}
.bal-val{
  font-family:'Cinzel Decorative';font-size:26px;
  color:var(--gold);letter-spacing:0.05em;
  transition:color 0.3s;
}
.bal-val.up{animation:countUp 0.4s ease;}
.bal-val.down{animation:countDown 0.4s ease;}
@keyframes countUp{0%{transform:scale(1.3);color:#6ddf6d;}100%{transform:scale(1);}}
@keyframes countDown{0%{transform:scale(1.3);color:#ff7575;}100%{transform:scale(1);}}
.bal-val.wins{color:#6ddf6d;}
.bal-val.losses{color:#ff7575;}
.reset-btn{
  font-family:'Cinzel';font-size:12px;letter-spacing:0.2em;
  padding:8px 20px;border:1px solid rgba(212,168,67,0.3);
  background:transparent;color:rgba(212,168,67,0.5);
  cursor:pointer;transition:all 0.3s;text-transform:uppercase;
}
.reset-btn:hover{border-color:var(--gold);color:var(--gold);background:rgba(212,168,67,0.07);}

/* ‚îÄ‚îÄ TABS ‚îÄ‚îÄ */
.nav-tabs{
  display:flex;justify-content:center;gap:0;
  position:relative;z-index:2;
  padding:24px 20px;
}
.tab-btn{
  font-family:'Cinzel';font-size:14px;letter-spacing:0.2em;
  padding:14px 36px;
  border:1px solid rgba(212,168,67,0.2);
  background:transparent;color:rgba(212,168,67,0.4);
  cursor:pointer;transition:all 0.4s;
  position:relative;overflow:hidden;
  text-transform:uppercase;
}
.tab-btn+.tab-btn{border-left:none;}
.tab-btn::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(212,168,67,0.1),transparent);
  opacity:0;transition:opacity 0.3s;
}
.tab-btn::after{
  content:'';position:absolute;bottom:0;left:0;right:0;height:2px;
  background:var(--gold);transform:scaleX(0);transition:transform 0.3s;
}
.tab-btn:hover::before,.tab-btn.active::before{opacity:1;}
.tab-btn.active{color:var(--gold2);border-color:rgba(212,168,67,0.4);}
.tab-btn.active::after{transform:scaleX(1);}

/* ‚îÄ‚îÄ GAME SECTIONS ‚îÄ‚îÄ */
.game-section{
  display:none;max-width:980px;margin:0 auto;
  padding:20px 20px 60px;
  position:relative;z-index:1;
}
.game-section.active{
  display:block;
  animation:sectionIn 0.5s cubic-bezier(0.34,1.56,0.64,1);
}
@keyframes sectionIn{
  0%{opacity:0;transform:translateY(24px) scale(0.97);}
  100%{opacity:1;transform:translateY(0) scale(1);}
}

.section-title{
  font-family:'Cinzel Decorative';font-size:28px;
  text-align:center;color:var(--gold);
  margin-bottom:30px;letter-spacing:0.05em;
  text-shadow:0 0 30px rgba(212,168,67,0.3);
}

/* ‚îÄ‚îÄ SHARED COMPONENTS ‚îÄ‚îÄ */
.chips-row{display:flex;justify-content:center;gap:14px;margin:16px 0;flex-wrap:wrap;}
.chip{
  width:56px;height:56px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-family:'Cinzel';font-size:12px;font-weight:700;
  cursor:pointer;
  border:3px solid rgba(255,255,255,0.25);
  transition:all 0.25s cubic-bezier(0.34,1.56,0.64,1);
  box-shadow:0 4px 16px rgba(0,0,0,0.6),inset 0 1px 0 rgba(255,255,255,0.25);
  user-select:none;position:relative;
}
.chip::after{
  content:'';position:absolute;inset:5px;border-radius:50%;
  border:1px dashed rgba(255,255,255,0.25);
}
.chip:hover{transform:translateY(-6px) scale(1.15);box-shadow:0 12px 30px rgba(0,0,0,0.7);}
.chip:active{transform:translateY(-2px) scale(1.05);}
.chip.c1{background:radial-gradient(circle at 35% 35%,#aaa,#666,#444);color:#fff;}
.chip.c5{background:radial-gradient(circle at 35% 35%,#e74c3c,#c0392b,#8b0000);color:#fff;}
.chip.c25{background:radial-gradient(circle at 35% 35%,#3498db,#2980b9,#1a5276);color:#fff;}
.chip.c100{background:radial-gradient(circle at 35% 35%,#2ecc71,#27ae60,#1a7a3c);color:#fff;}
.chip.c500{background:radial-gradient(circle at 35% 35%,#f1c40f,#d4a843,#8b6914);color:#1a0a00;}

.bet-amount{
  font-family:'Cinzel Decorative';font-size:28px;
  color:var(--gold2);text-align:center;
  margin:10px 0;
  text-shadow:0 0 20px rgba(212,168,67,0.4);
}

.btn-gold{
  font-family:'Cinzel';font-size:18px;letter-spacing:0.15em;
  padding:14px 56px;
  border:none;
  background:linear-gradient(135deg,var(--gold3),var(--gold),var(--gold2),var(--gold),var(--gold3));
  background-size:300% auto;
  color:#1a0800;font-weight:700;
  cursor:pointer;
  clip-path:polygon(12px 0%,100% 0%,calc(100% - 12px) 100%,0% 100%);
  transition:all 0.3s;
  box-shadow:0 4px 24px rgba(212,168,67,0.4);
  text-transform:uppercase;
  position:relative;overflow:hidden;
}
.btn-gold::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,0.3) 50%,transparent 100%);
  transform:translateX(-100%);
  transition:transform 0s;
}
.btn-gold:hover{
  background-position:right center;
  box-shadow:0 8px 40px rgba(212,168,67,0.7);
  transform:translateY(-2px);
}
.btn-gold:hover::before{transform:translateX(100%);transition:transform 0.5s;}
.btn-gold:active{transform:translateY(1px);}
.btn-gold:disabled{opacity:0.4;cursor:not-allowed;transform:none;box-shadow:none;}

.btn-outline{
  font-family:'Cinzel';font-size:13px;letter-spacing:0.15em;
  padding:9px 28px;border:1px solid rgba(212,168,67,0.35);
  background:transparent;color:var(--gold);
  cursor:pointer;transition:all 0.25s;text-transform:uppercase;
}
.btn-outline:hover{background:rgba(212,168,67,0.1);border-color:var(--gold);}

.result-msg{
  font-family:'Cinzel Decorative';font-size:20px;
  min-height:32px;text-align:center;
  transition:all 0.4s;letter-spacing:0.05em;
}
.result-msg.win{
  color:#6ddf6d;
  animation:winPop 0.6s cubic-bezier(0.34,1.56,0.64,1);
  text-shadow:0 0 30px rgba(109,223,109,0.7);
}
.result-msg.lose{color:#ff7575;animation:losePop 0.4s ease;}
.result-msg.push{color:var(--gold);}
@keyframes winPop{0%{transform:scale(0.5);opacity:0;}70%{transform:scale(1.15);}100%{transform:scale(1);opacity:1;}}
@keyframes losePop{0%{transform:translateX(-6px);}25%{transform:translateX(6px);}50%{transform:translateX(-4px);}75%{transform:translateX(4px);}100%{transform:translateX(0);}}

.divider{
  width:100%;height:1px;
  background:linear-gradient(90deg,transparent,rgba(212,168,67,0.3),transparent);
  margin:20px 0;
}

/* ‚îÄ‚îÄ SLOT MACHINE ‚îÄ‚îÄ */
.slot-shell{
  background:linear-gradient(160deg,#1c0800,#2a1000,#1c0800);
  border:2px solid var(--gold3);border-radius:20px;
  padding:40px;text-align:center;
  box-shadow:0 0 60px rgba(155,28,28,0.25),inset 0 0 50px rgba(0,0,0,0.6);
  position:relative;overflow:hidden;
}
.slot-shell::before{
  content:'';position:absolute;top:0;left:0;right:0;height:4px;
  background:linear-gradient(90deg,transparent,var(--gold2),var(--gold),var(--gold2),transparent);
  animation:topGlow 2s ease-in-out infinite alternate;
}
@keyframes topGlow{
  0%{opacity:0.5;}100%{opacity:1;box-shadow:0 0 20px var(--gold);}
}

.slot-reels-window{
  display:flex;justify-content:center;gap:16px;
  margin:30px 0;
  position:relative;
}
.slot-reels-window::before,.slot-reels-window::after{
  content:'';position:absolute;left:0;right:0;height:30%;
  pointer-events:none;z-index:3;
}
.slot-reels-window::before{top:0;background:linear-gradient(180deg,#1c0800,transparent);}
.slot-reels-window::after{bottom:0;background:linear-gradient(0deg,#1c0800,transparent);}

.reel-frame{
  width:100px;overflow:hidden;height:108px;
  border:2px solid var(--gold3);border-radius:10px;
  background:#080808;
  box-shadow:inset 0 0 20px rgba(0,0,0,0.9),0 0 0 1px rgba(212,168,67,0.1);
  position:relative;
}
.reel-strip{
  display:flex;flex-direction:column;
  transition:transform 0s;
}
.reel-symbol{
  height:108px;display:flex;align-items:center;justify-content:center;
  font-size:56px;flex-shrink:0;
}

/* winning line flash */
.win-line{
  position:absolute;top:50%;left:-8px;right:-8px;
  transform:translateY(-50%);height:4px;
  background:linear-gradient(90deg,transparent,var(--gold2),var(--gold),var(--gold2),transparent);
  opacity:0;pointer-events:none;z-index:5;
}
.win-line.flash{animation:linePulse 0.3s ease-in-out 4;}
@keyframes linePulse{0%,100%{opacity:0;}50%{opacity:1;box-shadow:0 0 20px var(--gold),0 0 40px var(--gold);}}

/* ‚îÄ‚îÄ ROULETTE ‚îÄ‚îÄ */
.roulette-layout{
  display:grid;grid-template-columns:260px 1fr;gap:28px;align-items:start;
}
@media(max-width:680px){.roulette-layout{grid-template-columns:1fr;}}

.wheel-wrap{
  display:flex;flex-direction:column;align-items:center;
  gap:16px;
}

/* Canvas wheel */
#wheelCanvas{
  border-radius:50%;
  border:4px solid var(--gold);
  box-shadow:0 0 40px rgba(212,168,67,0.4),0 0 80px rgba(212,168,67,0.1),inset 0 0 30px rgba(0,0,0,0.5);
  cursor:pointer;
}

.roul-number{
  font-family:'Cinzel Decorative';font-size:52px;
  min-height:64px;text-align:center;
  transition:all 0.3s;
}

.bet-panel{display:flex;flex-direction:column;gap:6px;}
.bet-row{display:flex;gap:6px;}
.bet-cell{
  flex:1;padding:10px 6px;
  border:1px solid rgba(212,168,67,0.2);
  background:rgba(212,168,67,0.03);
  text-align:center;cursor:pointer;
  font-family:'Cinzel';font-size:12px;letter-spacing:0.05em;
  transition:all 0.25s;color:var(--cream);
  position:relative;overflow:hidden;
}
.bet-cell::before{
  content:'';position:absolute;inset:0;
  background:rgba(212,168,67,0.15);
  transform:scaleX(0);transform-origin:left;
  transition:transform 0.25s;
}
.bet-cell:hover::before{transform:scaleX(1);}
.bet-cell.selected{border-color:var(--gold);color:var(--gold2);}
.bet-cell.selected::before{transform:scaleX(1);}
.bet-cell.red-cell{border-left:3px solid var(--red2);}
.bet-cell.blk-cell{border-left:3px solid #555;}
.bet-cell.grn-cell{border-left:3px solid #27ae60;color:#6ddf6d;}

/* ‚îÄ‚îÄ BLACKJACK ‚îÄ‚îÄ */
.felt-table{
  background:radial-gradient(ellipse at 50% 30%,var(--felt2) 0%,var(--felt) 60%,#040e07 100%);
  border:3px solid var(--gold3);
  border-radius:50% / 15%;
  padding:50px 40px;
  position:relative;
  box-shadow:0 0 60px rgba(0,0,0,0.8),inset 0 0 40px rgba(0,0,0,0.5),0 0 0 1px rgba(212,168,67,0.1);
  min-height:460px;
}
.felt-table::before{
  content:'';position:absolute;inset:10px;
  border:1px solid rgba(212,168,67,0.15);
  border-radius:50% / 12%;pointer-events:none;
}

.hand-zone{text-align:center;margin:16px 0;}
.hand-lbl{
  font-family:'Cinzel';font-size:10px;letter-spacing:0.35em;
  text-transform:uppercase;color:rgba(212,168,67,0.4);margin-bottom:14px;
}
.cards-row{
  display:flex;justify-content:center;flex-wrap:wrap;gap:10px;
  min-height:120px;align-items:center;
  perspective:800px;
}

/* 3D CARDS */
.card-wrap{perspective:600px;}
.card{
  width:76px;height:114px;border-radius:9px;
  position:relative;transform-style:preserve-3d;
  animation:dealCard 0.5s cubic-bezier(0.34,1.56,0.64,1) both;
}
@keyframes dealCard{
  0%{transform:translateY(-60px) rotateY(90deg) scale(0.7);opacity:0;}
  100%{transform:translateY(0) rotateY(0deg) scale(1);opacity:1;}
}
.card-front,.card-back{
  position:absolute;inset:0;border-radius:9px;
  backface-visibility:hidden;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  box-shadow:3px 5px 18px rgba(0,0,0,0.7);
}
.card-front{
  background:linear-gradient(135deg,#fff 0%,#f8f0e0 100%);
  border:1px solid #ddd;
}
.card-back{
  background:
    repeating-linear-gradient(45deg,#1a0030 0,#1a0030 2px,#2d0050 2px,#2d0050 8px);
  border:2px solid #5a0090;
  transform:rotateY(180deg);
}
.card-rank{font-size:22px;line-height:1;font-weight:700;}
.card-suit{font-size:28px;line-height:1;}
.card.red .card-rank,.card.red .card-suit{color:#c0392b;}
.card.black .card-rank,.card.black .card-suit{color:#1a1a1a;}

.hand-val{font-family:'Cinzel Decorative';font-size:26px;color:var(--gold2);margin-top:10px;}

.bj-controls{display:flex;justify-content:center;gap:14px;margin-top:24px;flex-wrap:wrap;}

/* ‚îÄ‚îÄ HISTORY ‚îÄ‚îÄ */
.history-wrap{
  margin-top:24px;
  border:1px solid rgba(212,168,67,0.15);border-radius:6px;
  overflow:hidden;max-height:180px;overflow-y:auto;
  background:rgba(0,0,0,0.35);
}
.history-item{
  display:flex;justify-content:space-between;
  padding:7px 14px;font-size:13px;
  border-bottom:1px solid rgba(255,255,255,0.04);
  animation:histSlide 0.3s ease;
}
@keyframes histSlide{from{opacity:0;transform:translateX(-10px);}to{opacity:1;transform:none;}}
.win-tag{color:#6ddf6d;font-weight:700;}
.lose-tag{color:#ff7575;}

/* ‚îÄ‚îÄ WIN OVERLAY ‚îÄ‚îÄ */
#winOverlay{
  position:fixed;inset:0;z-index:999;pointer-events:none;
  display:flex;align-items:center;justify-content:center;
}
#winText{
  font-family:'Cinzel Decorative';
  font-size:clamp(36px,8vw,96px);
  color:var(--gold2);
  text-shadow:0 0 40px var(--gold),0 0 80px var(--gold);
  opacity:0;
  transform:scale(0.5);
  transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1);
}
#winText.show{opacity:1;transform:scale(1);}

/* scrollbar */
::-webkit-scrollbar{width:5px;}
::-webkit-scrollbar-track{background:rgba(0,0,0,0.2);}
::-webkit-scrollbar-thumb{background:var(--gold3);border-radius:3px;}

/* ‚îÄ‚îÄ COIN CANVAS ‚îÄ‚îÄ */
#coinCanvas{position:fixed;inset:0;pointer-events:none;z-index:998;}

footer{
  position:relative;z-index:2;
  text-align:center;padding:28px;
  border-top:1px solid rgba(212,168,67,0.1);
  color:rgba(212,168,67,0.25);
  font-family:'Cinzel';font-size:11px;letter-spacing:0.2em;text-transform:uppercase;
}
</style>
</head>
<body>

<!-- Canvases -->
<canvas id="bgCanvas"></canvas>
<canvas id="coinCanvas"></canvas>
<div id="winOverlay"><div id="winText"></div></div>

<header>
  <div class="logo-wrap">
    <span class="crown-anim">‚ôõ</span>
    <div class="casino-name">Velvet Crown</div>
    <div class="neon-sub">Est. MMXXV ¬∑ Where Fortune Favours the Bold</div>
  </div>
</header>

<div class="balance-bar">
  <div class="bal-item">
    <span class="bal-label">Balance</span>
    <span class="bal-val" id="balVal">$1,000</span>
  </div>
  <div class="bal-item">
    <span class="bal-label">Total Won</span>
    <span class="bal-val wins" id="wonVal">$0</span>
  </div>
  <div class="bal-item">
    <span class="bal-label">Total Lost</span>
    <span class="bal-val losses" id="lostVal">$0</span>
  </div>
  <div class="bal-item">
    <span class="bal-label">Rounds</span>
    <span class="bal-val" id="rounVal">0</span>
  </div>
  <button class="reset-btn" onclick="resetAll()">‚Ü∫ Reset</button>
</div>

<div class="nav-tabs">
  <button class="tab-btn active" onclick="goTab('slots',this)">üé∞ Slots</button>
  <button class="tab-btn" onclick="goTab('roulette',this)">üé° Roulette</button>
  <button class="tab-btn" onclick="goTab('blackjack',this)">üÉè Blackjack</button>
</div>

<!-- ‚ïê‚ïê SLOTS ‚ïê‚ïê -->
<div id="slots" class="game-section active">
  <h2 class="section-title">‚ü° Slot Royale ‚ü°</h2>
  <div class="slot-shell">
    <div class="slot-reels-window">
      <div class="win-line" id="winLine"></div>
      <div class="reel-frame"><div class="reel-strip" id="strip0"></div></div>
      <div class="reel-frame"><div class="reel-strip" id="strip1"></div></div>
      <div class="reel-frame"><div class="reel-strip" id="strip2"></div></div>
    </div>

    <div class="divider"></div>

    <div style="font-family:'Cinzel';font-size:10px;letter-spacing:.3em;color:rgba(212,168,67,.4);margin-bottom:12px;text-transform:uppercase">Select Chip</div>
    <div class="chips-row">
      <div class="chip c1" onclick="addBet('slot',1)">$1</div>
      <div class="chip c5" onclick="addBet('slot',5)">$5</div>
      <div class="chip c25" onclick="addBet('slot',25)">$25</div>
      <div class="chip c100" onclick="addBet('slot',100)">$100</div>
      <div class="chip c500" onclick="addBet('slot',500)">$500</div>
    </div>

    <div style="display:flex;align-items:center;justify-content:center;gap:20px;margin:10px 0;flex-wrap:wrap;">
      <button class="btn-outline" onclick="bets.slot=0;updBetD('slot')">Clear</button>
      <div class="bet-amount">BET: $<span id="slotBetD">0</span></div>
      <button class="btn-outline" onclick="bets.slot=Math.min(balance,500);updBetD('slot')">Max</button>
    </div>

    <button class="btn-gold" onclick="spinSlots()" id="spinBtn">SPIN</button>
    <div class="divider"></div>
    <div class="result-msg" id="slotRes"></div>
    <div style="margin-top:14px;font-family:'Cinzel';font-size:10px;color:rgba(212,168,67,.3);letter-spacing:.15em;text-transform:uppercase;">
      3-Match √ó10 &nbsp;¬∑&nbsp; 2-Match √ó2 &nbsp;¬∑&nbsp; üíéüíéüíé √ó50 &nbsp;¬∑&nbsp; 7Ô∏è‚É£7Ô∏è‚É£7Ô∏è‚É£ √ó25
    </div>
  </div>
  <div class="history-wrap" id="slotHist"></div>
</div>

<!-- ‚ïê‚ïê ROULETTE ‚ïê‚ïê -->
<div id="roulette" class="game-section">
  <h2 class="section-title">‚ü° Roulette Royale ‚ü°</h2>
  <div class="roulette-layout">
    <div class="wheel-wrap">
      <canvas id="wheelCanvas" width="240" height="240"></canvas>
      <div class="roul-number" id="roulNum">‚Äî</div>
      <div class="result-msg" id="roulRes"></div>
      <div class="divider"></div>
      <div class="chips-row">
        <div class="chip c1" onclick="addBet('roul',1)">$1</div>
        <div class="chip c5" onclick="addBet('roul',5)">$5</div>
        <div class="chip c25" onclick="addBet('roul',25)">$25</div>
        <div class="chip c100" onclick="addBet('roul',100)">$100</div>
      </div>
      <div class="bet-amount">BET: $<span id="roulBetD">0</span></div>
      <button class="btn-gold" onclick="spinRoulette()" id="roulBtn" style="margin-top:10px;">SPIN</button>
    </div>

    <div class="bet-panel">
      <div style="font-family:'Cinzel';font-size:10px;letter-spacing:.3em;color:rgba(212,168,67,.4);margin-bottom:8px;text-align:center;text-transform:uppercase;">Choose Wager</div>
      <div class="bet-row">
        <div class="bet-cell red-cell" onclick="selRT('red')" id="rt-red">RED 2√ó</div>
        <div class="bet-cell blk-cell" onclick="selRT('black')" id="rt-black">BLACK 2√ó</div>
      </div>
      <div class="bet-row">
        <div class="bet-cell" onclick="selRT('odd')" id="rt-odd">ODD 2√ó</div>
        <div class="bet-cell" onclick="selRT('even')" id="rt-even">EVEN 2√ó</div>
      </div>
      <div class="bet-row">
        <div class="bet-cell" onclick="selRT('low')" id="rt-low">1‚Äì18 &nbsp;2√ó</div>
        <div class="bet-cell" onclick="selRT('high')" id="rt-high">19‚Äì36  2√ó</div>
      </div>
      <div class="divider"></div>
      <div class="bet-row">
        <div class="bet-cell" onclick="selRT('d1')" id="rt-d1">1st Dozen 3√ó</div>
        <div class="bet-cell" onclick="selRT('d2')" id="rt-d2">2nd Dozen 3√ó</div>
        <div class="bet-cell" onclick="selRT('d3')" id="rt-d3">3rd Dozen 3√ó</div>
      </div>
      <div class="divider"></div>
      <div style="font-family:'Cinzel';font-size:10px;letter-spacing:.25em;color:rgba(212,168,67,.35);margin-bottom:6px;text-align:center;text-transform:uppercase;">Straight Up 36√ó</div>
      <div id="numGrid"></div>
      <div class="bet-row" style="margin-top:6px;">
        <div class="bet-cell grn-cell" onclick="selRT('zero')" id="rt-zero">0 ‚Äî GREEN 36√ó</div>
      </div>
    </div>
  </div>
  <div class="history-wrap" id="roulHist"></div>
</div>

<!-- ‚ïê‚ïê BLACKJACK ‚ïê‚ïê -->
<div id="blackjack" class="game-section">
  <h2 class="section-title">‚ü° Blackjack ‚ü°</h2>
  <div class="felt-table">
    <div class="hand-zone">
      <div class="hand-lbl">Dealer's Hand</div>
      <div class="cards-row" id="dealerCards"></div>
      <div class="hand-val" id="dealerVal"></div>
    </div>
    <div class="divider"></div>
    <div class="hand-zone">
      <div class="hand-lbl">Your Hand</div>
      <div class="cards-row" id="playerCards"></div>
      <div class="hand-val" id="playerVal"></div>
    </div>
  </div>

  <div style="text-align:center;margin-top:24px;">
    <div class="chips-row">
      <div class="chip c1" onclick="addBet('bj',1)">$1</div>
      <div class="chip c5" onclick="addBet('bj',5)">$5</div>
      <div class="chip c25" onclick="addBet('bj',25)">$25</div>
      <div class="chip c100" onclick="addBet('bj',100)">$100</div>
      <div class="chip c500" onclick="addBet('bj',500)">$500</div>
    </div>
    <div class="bet-amount">BET: $<span id="bjBetD">0</span></div>
    <div class="result-msg" id="bjRes"></div>
    <div class="bj-controls" id="bjCtrl">
      <button class="btn-gold" onclick="dealBJ()">DEAL</button>
    </div>
  </div>
  <div class="history-wrap" id="bjHist"></div>
</div>

<footer>Velvet Crown Casino &nbsp;¬∑&nbsp; Play Responsibly &nbsp;¬∑&nbsp; 18+ &nbsp;¬∑&nbsp; Entertainment Only</footer>

<script>
// ‚ïê‚ïê STATE ‚ïê‚ïê
let balance=1000,won=0,lost=0,rounds=0;
const bets={slot:0,roul:0,bj:0};
let roulType=null,bjActive=false,pHand=[],dHand=[],deck=[];

// ‚ïê‚ïê UI HELPERS ‚ïê‚ïê
function fmt(n){return'$'+Math.abs(n).toLocaleString();}

function animBal(el,cls){
  el.classList.remove('up','down');
  void el.offsetWidth;
  el.classList.add(cls);
}

function updateUI(){
  const bEl=document.getElementById('balVal');
  bEl.textContent=fmt(balance);
  document.getElementById('wonVal').textContent=fmt(won);
  document.getElementById('lostVal').textContent=fmt(lost);
  document.getElementById('rounVal').textContent=rounds;
}

function processNet(net){
  const prev=balance;
  balance+=net;
  if(net>0)won+=net; else if(net<0)lost+=Math.abs(net);
  rounds++;
  const bEl=document.getElementById('balVal');
  animateBal(bEl,prev,balance);
  document.getElementById('wonVal').textContent=fmt(won);
  document.getElementById('lostVal').textContent=fmt(lost);
  document.getElementById('rounVal').textContent=rounds;
}

function animateBal(el,from,to){
  const start=performance.now(),dur=600;
  function step(now){
    const p=Math.min((now-start)/dur,1);
    const ease=1-(1-p)*(1-p);
    el.textContent='$'+Math.round(from+(to-from)*ease).toLocaleString();
    if(p<1)requestAnimationFrame(step);
    else{
      el.textContent=fmt(to);
      animBal(el,to>from?'up':'down');
    }
  }
  requestAnimationFrame(step);
}

function addBet(game,amt){
  bets[game]=Math.min(bets[game]+amt,balance);
  updBetD(game);
}
function updBetD(game){
  const ids={slot:'slotBetD',roul:'roulBetD',bj:'bjBetD'};
  document.getElementById(ids[game]).textContent=bets[game];
}

function addHistory(id,txt,net){
  const wrap=document.getElementById(id);
  const d=document.createElement('div');d.className='history-item';
  const t=new Date().toLocaleTimeString();
  d.innerHTML=`<span>${t} ‚Äî ${txt}</span><span class="${net>0?'win-tag':net<0?'lose-tag':''}">${net>0?'+':''}${fmt(net)}</span>`;
  wrap.prepend(d);
}

function setRes(id,msg,cls){
  const el=document.getElementById(id);
  el.textContent=msg;el.className='result-msg '+cls;
}

function goTab(name,btn){
  document.querySelectorAll('.game-section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById(name).classList.add('active');
  btn.classList.add('active');
}

function resetAll(){
  balance=1000;won=0;lost=0;rounds=0;
  bets.slot=0;bets.roul=0;bets.bj=0;
  ['slotBetD','roulBetD','bjBetD'].forEach(id=>document.getElementById(id).textContent='0');
  updateUI();
}

// ‚ïê‚ïê BG PARTICLES ‚ïê‚ïê
(function(){
  const c=document.getElementById('bgCanvas');
  const ctx=c.getContext('2d');
  let W,H,particles=[];
  function resize(){c.width=W=innerWidth;c.height=H=innerHeight;}
  resize();window.addEventListener('resize',resize);

  class P{
    constructor(){this.reset();}
    reset(){
      this.x=Math.random()*W;
      this.y=Math.random()*H;
      this.r=Math.random()*1.5+0.3;
      this.vx=(Math.random()-.5)*0.3;
      this.vy=-Math.random()*0.5-0.1;
      this.life=Math.random();
      this.maxLife=0.6+Math.random()*0.4;
      this.gold=Math.random()>.5;
    }
    update(){
      this.x+=this.vx;this.y+=this.vy;
      this.life+=0.002;
      if(this.life>this.maxLife||this.y<-5)this.reset();
    }
    draw(){
      const a=Math.sin((this.life/this.maxLife)*Math.PI)*0.6;
      ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
      ctx.fillStyle=this.gold?`rgba(212,168,67,${a})`:`rgba(155,28,28,${a*0.6})`;
      ctx.fill();
    }
  }

  for(let i=0;i<180;i++)particles.push(new P());

  function loop(){
    ctx.clearRect(0,0,W,H);
    particles.forEach(p=>{p.update();p.draw();});
    requestAnimationFrame(loop);
  }
  loop();
})();

// ‚ïê‚ïê COIN RAIN ‚ïê‚ïê
(function(){
  const c=document.getElementById('coinCanvas');
  const ctx=c.getContext('2d');
  let W,H,coins=[],active=false;
  function resize(){c.width=W=innerWidth;c.height=H=innerHeight;}
  resize();window.addEventListener('resize',resize);

  class Coin{
    constructor(){
      this.x=Math.random()*W;
      this.y=-20;
      this.r=6+Math.random()*10;
      this.vx=(Math.random()-.5)*6;
      this.vy=4+Math.random()*6;
      this.rot=Math.random()*Math.PI*2;
      this.rotV=(Math.random()-.5)*0.3;
      this.hue=40+Math.random()*20;
      this.life=0;
    }
    update(){
      this.x+=this.vx;this.vy+=0.15;this.y+=this.vy;
      this.rot+=this.rotV;this.life++;
    }
    draw(){
      const scaleX=Math.cos(this.rot);
      ctx.save();
      ctx.translate(this.x,this.y);
      ctx.scale(scaleX,1);
      ctx.beginPath();ctx.ellipse(0,0,this.r,this.r,0,0,Math.PI*2);
      const g=ctx.createRadialGradient(-this.r*.3,-this.r*.3,0,0,0,this.r);
      g.addColorStop(0,`hsl(${this.hue+20},90%,80%)`);
      g.addColorStop(1,`hsl(${this.hue},80%,45%)`);
      ctx.fillStyle=g;ctx.fill();
      ctx.strokeStyle=`hsl(${this.hue-10},70%,35%)`;ctx.lineWidth=1;ctx.stroke();
      ctx.restore();
    }
  }

  function spawnBurst(){
    active=true;
    for(let i=0;i<80;i++){
      setTimeout(()=>coins.push(new Coin()),Math.random()*1000);
    }
    setTimeout(()=>{active=false;},3000);
  }
  window.coinBurst=spawnBurst;

  function loop(){
    ctx.clearRect(0,0,W,H);
    coins=coins.filter(c=>{c.update();if(c.y<H+50){c.draw();return true;}return false;});
    requestAnimationFrame(loop);
  }
  loop();
})();

// ‚ïê‚ïê WIN SCREEN ‚ïê‚ïê
function showBigWin(msg){
  const el=document.getElementById('winText');
  el.textContent=msg;
  el.classList.add('show');
  coinBurst();
  setTimeout(()=>el.classList.remove('show'),2200);
}

// ‚ïê‚ïê SLOTS ‚ïê‚ïê
const SYMS=['üçí','üçã','üçä','üçá','üîî','‚≠ê','7Ô∏è‚É£','üíé'];
const WEIGHTS=[25,20,17,14,10,7,4,3];

function wRand(){
  const tot=WEIGHTS.reduce((a,b)=>a+b,0);
  let r=Math.random()*tot;
  for(let i=0;i<SYMS.length;i++){r-=WEIGHTS[i];if(r<=0)return SYMS[i];}
  return SYMS[0];
}

// Build reel strips (loop of symbols for animation)
function buildStrips(){
  for(let r=0;r<3;r++){
    const strip=document.getElementById('strip'+r);
    strip.innerHTML='';
    // 30 symbols for scroll
    for(let i=0;i<30;i++){
      const d=document.createElement('div');
      d.className='reel-symbol';
      d.textContent=SYMS[Math.floor(Math.random()*SYMS.length)];
      strip.appendChild(d);
    }
  }
}
buildStrips();

let slotSpinning=false;

function spinSlots(){
  if(slotSpinning)return;
  if(bets.slot<=0){setRes('slotRes','Place a bet first','');return;}
  if(bets.slot>balance){setRes('slotRes','Insufficient funds!','lose');return;}

  slotSpinning=true;
  document.getElementById('spinBtn').disabled=true;
  document.getElementById('winLine').classList.remove('flash');
  setRes('slotRes','','');

  const results=[];
  const delays=[700,1100,1500];

  for(let r=0;r<3;r++){
    const strip=document.getElementById('strip'+r);
    const sym=wRand();results.push(sym);

    // Spin animation: fast scroll, then land on target
    let frame=0;
    let speed=60;
    let pos=0;
    const total=108;
    const targetIdx=Math.floor(Math.random()*20)+5;

    // CSS animation: translateY cycling
    strip.style.transition='none';
    strip.style.transform='translateY(0px)';

    const spinInterval=setInterval(()=>{
      pos-=speed;
      if(Math.abs(pos)>total*28)pos=0; // loop
      strip.style.transform=`translateY(${pos}px)`;
      frame++;
    },16);

    (function(idx,interval,target,delay){
      setTimeout(()=>{
        clearInterval(interval);
        // Rebuild strip so last visible symbol = target
        strip.innerHTML='';
        const extra=5;
        for(let i=0;i<extra;i++){
          const d=document.createElement('div');d.className='reel-symbol';
          d.textContent=SYMS[Math.floor(Math.random()*SYMS.length)];strip.appendChild(d);
        }
        // target symbol is at position `extra`
        const td=document.createElement('div');td.className='reel-symbol';td.textContent=target;strip.appendChild(td);
        for(let i=0;i<4;i++){
          const d=document.createElement('div');d.className='reel-symbol';
          d.textContent=SYMS[Math.floor(Math.random()*SYMS.length)];strip.appendChild(d);
        }

        strip.style.transition='none';
        strip.style.transform=`translateY(-${extra*108}px)`;

        // Bounce settle
        setTimeout(()=>{
          strip.style.transition='transform 0.4s cubic-bezier(0.34,1.56,0.64,1)';
          strip.style.transform=`translateY(-${extra*108}px)`;
        },20);

        if(idx===2){
          setTimeout(()=>evalSlots(results),450);
        }
      },delay);
    })(r,spinInterval,sym,delays[r]);
  }
}

function evalSlots(r){
  slotSpinning=false;
  document.getElementById('spinBtn').disabled=false;

  let mult=0;
  if(r[0]===r[1]&&r[1]===r[2]){
    mult=r[0]==='üíé'?50:r[0]==='7Ô∏è‚É£'?25:10;
  } else if(r[0]===r[1]||r[1]===r[2]||r[0]===r[2]) mult=2;

  if(mult>0){
    document.getElementById('winLine').classList.add('flash');
    const net=bets.slot*mult;
    processNet(net);
    setRes('slotRes',`‚ú¶ ${mult}√ó WIN ‚Äî You earned ${fmt(net)}! ‚ú¶`,'win');
    addHistory('slotHist',`Slots [${r.join('')}] √ó${mult}`,net);
    if(mult>=10)showBigWin(`${mult}√ó WIN!`);
    else coinBurst();
  } else {
    const net=-bets.slot;
    processNet(net);
    setRes('slotRes','No match ‚Äî spin again','lose');
    addHistory('slotHist',`Slots [${r.join('')}]`,net);
  }
  bets.slot=0;updBetD('slot');
}

// ‚ïê‚ïê ROULETTE WHEEL (Canvas) ‚ïê‚ïê
(function(){
  const canvas=document.getElementById('wheelCanvas');
  const ctx=canvas.getContext('2d');
  const W=240,CX=120,CY=120,R=110;
  const reds=[1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
  const nums=[0,32,15,19,4,21,2,25,17,34,6,27,13,36,11,30,8,23,10,5,24,16,33,1,20,14,31,9,22,18,29,7,28,12,35,3,26];

  let angle=0,ballAngle=0,ballR=R-12,spinning=false;
  let targetAngle=0,ballTarget=0,startTime=0,duration=4000;
  let ballVisible=false;
  let landedNum=null;

  function drawWheel(rot,bAngle,bRad){
    ctx.clearRect(0,0,W,W);
    const n=nums.length;
    const sliceAngle=Math.PI*2/n;

    // Draw slices
    for(let i=0;i<n;i++){
      const start=rot+i*sliceAngle-sliceAngle/2;
      const end=start+sliceAngle;
      const num=nums[i];
      ctx.beginPath();
      ctx.moveTo(CX,CY);
      ctx.arc(CX,CY,R,start,end);
      ctx.closePath();
      ctx.fillStyle=num===0?'#1a7a1a':reds.includes(num)?'#8b1a1a':'#1a1a1a';
      ctx.fill();
      ctx.strokeStyle='rgba(212,168,67,0.25)';ctx.lineWidth=1;ctx.stroke();

      // Number text
      const mid=start+sliceAngle/2;
      const tx=CX+Math.cos(mid)*(R-20);
      const ty=CY+Math.sin(mid)*(R-20);
      ctx.save();ctx.translate(tx,ty);ctx.rotate(mid+Math.PI/2);
      ctx.fillStyle='rgba(255,255,255,0.85)';
      ctx.font='bold 9px Cinzel,serif';ctx.textAlign='center';ctx.textBaseline='middle';
      ctx.fillText(num,0,0);
      ctx.restore();
    }

    // Outer ring
    ctx.beginPath();ctx.arc(CX,CY,R+2,0,Math.PI*2);
    ctx.strokeStyle='rgba(212,168,67,0.5)';ctx.lineWidth=3;ctx.stroke();

    // Center
    const cg=ctx.createRadialGradient(CX,CY,0,CX,CY,22);
    cg.addColorStop(0,'#f7d98b');cg.addColorStop(1,'#8b6914');
    ctx.beginPath();ctx.arc(CX,CY,22,0,Math.PI*2);
    ctx.fillStyle=cg;ctx.fill();
    ctx.strokeStyle='rgba(212,168,67,0.8)';ctx.lineWidth=2;ctx.stroke();
    ctx.fillStyle='#3a2000';ctx.font='14px serif';ctx.textAlign='center';ctx.textBaseline='middle';
    ctx.fillText('‚ôõ',CX,CY);

    // Pointer
    ctx.beginPath();ctx.moveTo(CX,CY-R-4);ctx.lineTo(CX-7,CY-R+12);ctx.lineTo(CX+7,CY-R+12);
    ctx.closePath();ctx.fillStyle='#f7d98b';ctx.fill();
    ctx.strokeStyle='#8b6914';ctx.lineWidth=1;ctx.stroke();

    // Ball
    if(bRad!==undefined){
      const bx=CX+Math.cos(bAngle)*bRad;
      const by=CY+Math.sin(bAngle)*bRad;
      const bg=ctx.createRadialGradient(bx-2,by-2,0,bx,by,6);
      bg.addColorStop(0,'#ffffff');bg.addColorStop(1,'#aaaaaa');
      ctx.beginPath();ctx.arc(bx,by,5.5,0,Math.PI*2);
      ctx.fillStyle=bg;ctx.fill();
      ctx.strokeStyle='rgba(0,0,0,0.5)';ctx.lineWidth=1;ctx.stroke();
    }
  }

  function easeOut(t){return 1-Math.pow(1-t,4);}
  function easeOutBounce(t){
    if(t<0.7273)return 7.5625*t*t;
    if(t<0.9091){t-=0.8182;return 7.5625*t*t+0.75;}
    if(t<0.9773){t-=0.9545;return 7.5625*t*t+0.9375;}
    t-=0.9886;return 7.5625*t*t+0.984375;
  }

  let animID=null;
  function animate(ts){
    if(!startTime)startTime=ts;
    const elapsed=ts-startTime;
    const p=Math.min(elapsed/duration,1);
    const ep=easeOut(p);

    angle=targetAngle*ep%(Math.PI*2);
    const bp=easeOut(Math.min(elapsed/(duration*0.8),1));
    ballAngle=ballTarget*bp%(Math.PI*2);
    ballR=R-12-(1-ep)*40;

    drawWheel(angle,ballAngle,ballVisible?ballR:undefined);

    if(p<1){animID=requestAnimationFrame(animate);}
    else{
      drawWheel(angle,ballAngle,ballR);
      resolveSpin();
    }
  }

  function resolveSpin(){
    // find landed slot
    const pointerAngle=(-angle+Math.PI*2*100)%(Math.PI*2);
    const n=nums.length,sliceAngle=Math.PI*2/n;
    const idx=Math.floor(pointerAngle/sliceAngle)%n;
    landedNum=nums[idx];
    window._roulLanded=landedNum;
    window._roulCallback&&window._roulCallback(landedNum);
  }

  window.startWheelSpin=function(cb){
    if(spinning)return;
    spinning=true;ballVisible=true;
    window._roulCallback=function(num){spinning=false;cb(num);};
    startTime=0;
    targetAngle=Math.PI*2*(8+Math.random()*12);
    ballTarget=-(Math.PI*2*(10+Math.random()*15));
    duration=4000;
    animID=requestAnimationFrame(animate);
  };

  // Initial draw
  drawWheel(0);
})();

// Roulette game logic
const reds=[1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];

function addBet(game,amt){
  bets[game]=Math.min(bets[game]+amt,balance);
  updBetD(game);
}

function selRT(type){
  roulType=type;
  document.querySelectorAll('.bet-cell').forEach(c=>c.classList.remove('selected'));
  const el=document.getElementById('rt-'+type);
  if(el)el.classList.add('selected');
}

function spinRoulette(){
  if(bets.roul<=0){alert('Place a bet!');return;}
  if(!roulType){alert('Choose a bet type!');return;}
  if(bets.roul>balance){alert('Insufficient funds!');return;}

  document.getElementById('roulBtn').disabled=true;
  setRes('roulRes','','');
  document.getElementById('roulNum').textContent='‚öô';

  startWheelSpin(function(num){
    const col=num===0?'üü¢':reds.includes(num)?'üî¥':'‚ö´';
    document.getElementById('roulNum').textContent=`${col} ${num}`;
    document.getElementById('roulNum').style.animation='winPop 0.6s cubic-bezier(0.34,1.56,0.64,1)';

    let mult=0;
    switch(roulType){
      case 'red':if(num>0&&reds.includes(num))mult=2;break;
      case 'black':if(num>0&&!reds.includes(num))mult=2;break;
      case 'odd':if(num>0&&num%2!==0)mult=2;break;
      case 'even':if(num>0&&num%2===0)mult=2;break;
      case 'low':if(num>=1&&num<=18)mult=2;break;
      case 'high':if(num>=19&&num<=36)mult=2;break;
      case 'd1':if(num>=1&&num<=12)mult=3;break;
      case 'd2':if(num>=13&&num<=24)mult=3;break;
      case 'd3':if(num>=25&&num<=36)mult=3;break;
      case 'zero':if(num===0)mult=36;break;
      default:if(roulType==='n'+num)mult=36;
    }

    let net;
    if(mult>0){
      net=bets.roul*(mult-1);
      processNet(net);
      setRes('roulRes',`WIN! +${fmt(net)} (${mult}√ó)`,'win');
      addHistory('roulHist',`Roulette #${num} [${roulType}]`,net);
      if(mult>=10)showBigWin(`JACKPOT! ${mult}√ó`);
      else coinBurst();
    } else {
      net=-bets.roul;
      processNet(net);
      setRes('roulRes',`Lost ‚Äî #${num} missed ${roulType}`,'lose');
      addHistory('roulHist',`Roulette #${num} [${roulType}]`,net);
    }

    bets.roul=0;updBetD('roul');roulType=null;
    document.querySelectorAll('.bet-cell').forEach(c=>c.classList.remove('selected'));
    document.getElementById('roulBtn').disabled=false;
  });
}

// Build number grid
(function(){
  const grid=document.getElementById('numGrid');
  for(let row=0;row<4;row++){
    const div=document.createElement('div');div.className='bet-row';
    for(let col=0;col<9;col++){
      const n=row*9+col+1;if(n>36)break;
      const cell=document.createElement('div');
      cell.className='bet-cell '+(reds.includes(n)?'red-cell':'blk-cell');
      cell.id='rt-n'+n;cell.textContent=n;
      cell.style.cssText='font-size:11px;padding:6px 2px;';
      cell.onclick=()=>selRT('n'+n);
      div.appendChild(cell);
    }
    grid.appendChild(div);
  }
})();

// ‚ïê‚ïê BLACKJACK ‚ïê‚ïê
function mkDeck(){
  const suits=['‚ô†','‚ô•','‚ô¶','‚ô£'],ranks=['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
  const d=[];
  for(const s of suits)for(const r of ranks)d.push({s,r});
  for(let i=d.length-1;i>0;i--){const j=~~(Math.random()*(i+1));[d[i],d[j]]=[d[j],d[i]];}
  return d;
}

function cVal(r){
  if(['J','Q','K'].includes(r))return 10;
  if(r==='A')return 11;
  return parseInt(r);
}

function hVal(hand){
  let v=0,a=0;
  for(const c of hand){v+=cVal(c.r);if(c.r==='A')a++;}
  while(v>21&&a>0){v-=10;a--;}
  return v;
}

function mkCardEl(card,hidden,delay){
  const wrap=document.createElement('div');
  wrap.className='card-wrap';
  const el=document.createElement('div');
  const isRed=['‚ô•','‚ô¶'].includes(card.s);
  el.className='card '+(isRed?'red':'black');
  el.style.animationDelay=delay+'ms';
  if(!hidden){
    const front=document.createElement('div');front.className='card-front';
    const r=document.createElement('div');r.className='card-rank';r.textContent=card.r;
    const s=document.createElement('div');s.className='card-suit';s.textContent=card.s;
    front.appendChild(r);front.appendChild(s);el.appendChild(front);
  } else {
    const back=document.createElement('div');back.className='card-back';el.appendChild(back);
  }
  wrap.appendChild(el);return wrap;
}

function renderBJ(reveal){
  document.getElementById('dealerCards').innerHTML='';
  document.getElementById('playerCards').innerHTML='';
  dHand.forEach((c,i)=>document.getElementById('dealerCards').appendChild(mkCardEl(c,!reveal&&i===1,i*120)));
  pHand.forEach((c,i)=>document.getElementById('playerCards').appendChild(mkCardEl(c,false,i*120)));
  document.getElementById('dealerVal').textContent=reveal?'Dealer: '+hVal(dHand):'Dealer: ?';
  document.getElementById('playerVal').textContent='You: '+hVal(pHand);
}

function dealBJ(){
  if(bets.bj<=0){alert('Place a bet!');return;}
  if(bets.bj>balance){alert('Insufficient funds!');return;}
  bjActive=true;deck=mkDeck();
  pHand=[deck.pop(),deck.pop()];dHand=[deck.pop(),deck.pop()];
  renderBJ(false);
  setRes('bjRes','','');
  document.getElementById('bjCtrl').innerHTML=`
    <button class="btn-gold" onclick="bjHit()">HIT</button>
    <button class="btn-outline" onclick="bjStand()">STAND</button>
    <button class="btn-outline" onclick="bjDbl()">DOUBLE</button>`;
  if(hVal(pHand)===21)bjStand();
}

function bjHit(){
  pHand.push(deck.pop());renderBJ(false);
  if(hVal(pHand)>21)endBJ('bust');
  else if(hVal(pHand)===21)bjStand();
}

function bjStand(){
  while(hVal(dHand)<17)dHand.push(deck.pop());
  renderBJ(true);
  const pv=hVal(pHand),dv=hVal(dHand);
  if(dv>21)endBJ('dbust');
  else if(pv>dv)endBJ('win');
  else if(pv<dv)endBJ('lose');
  else endBJ('push');
}

function bjDbl(){
  const ex=Math.min(bets.bj,balance-bets.bj);bets.bj+=ex;updBetD('bj');
  pHand.push(deck.pop());renderBJ(false);
  if(hVal(pHand)>21)endBJ('bust');else bjStand();
}

function endBJ(outcome){
  bjActive=false;renderBJ(true);
  const pv=hVal(pHand),dv=hVal(dHand);
  const nat=pv===21&&pHand.length===2;
  let net,msg,cls;
  switch(outcome){
    case 'bust':net=-bets.bj;msg=`Bust! (${pv})`;cls='lose';break;
    case 'dbust':
    case 'win':net=nat?Math.floor(bets.bj*1.5):bets.bj;msg=nat?`Blackjack! ${fmt(net)}`:`You win! ${pv} vs ${dv} ‚Äî ${fmt(net)}`;cls='win';break;
    case 'lose':net=-bets.bj;msg=`Dealer wins. ${dv} vs ${pv}`;cls='lose';break;
    case 'push':net=0;msg=`Push ‚Äî ${pv} tie`;cls='push';break;
  }
  setRes('bjRes',msg,cls);
  processNet(net);
  addHistory('bjHist',`Blackjack [${pv} vs ${dv}]`,net);
  if(net>0){if(nat)showBigWin('BLACKJACK!');else coinBurst();}
  document.getElementById('bjCtrl').innerHTML=`<button class="btn-gold" onclick="newBJHand()">DEAL AGAIN</button>`;
  bets.bj=0;updBetD('bj');
}

function newBJHand(){
  ['dealerCards','playerCards'].forEach(id=>document.getElementById(id).innerHTML='');
  ['dealerVal','playerVal'].forEach(id=>document.getElementById(id).textContent='');
  setRes('bjRes','','');
  document.getElementById('bjCtrl').innerHTML=`<button class="btn-gold" onclick="dealBJ()">DEAL</button>`;
}

updateUI();
</script>
</body>
</html>
